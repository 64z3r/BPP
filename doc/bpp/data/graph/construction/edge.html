<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>bpp.data.graph.construction.edge API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../construction.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;bpp.data.graph.construction</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#AromaticSulphur">AromaticSulphur</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AromaticSulphur.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#AromaticSulphur.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#AromaticSulphur.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Aromatic">Aromatic</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Aromatic.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#Aromatic.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Aromatic.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CationPi">CationPi</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CationPi.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#CationPi.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#CationPi.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Covalent">Covalent</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Covalent.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#Covalent.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Covalent.tolerance">tolerance</a>
                        </li>
                        <li>
                                <a class="variable" href="#Covalent.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Delaunay">Delaunay</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Delaunay.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#Delaunay.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Delaunay.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Disulfide">Disulfide</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Disulfide.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#Disulfide.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Disulfide.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#HydrogenBond">HydrogenBond</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#HydrogenBond.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#HydrogenBond.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#HydrogenBond.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Ionic">Ionic</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Ionic.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#Ionic.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Ionic.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#KNN">KNN</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#KNN.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#KNN.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#KNN.long_interaction_threshold">long_interaction_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#KNN.k">k</a>
                        </li>
                        <li>
                                <a class="variable" href="#KNN.exclude_edges">exclude_edges</a>
                        </li>
                        <li>
                                <a class="variable" href="#KNN.exclude_self_loops">exclude_self_loops</a>
                        </li>
                        <li>
                                <a class="variable" href="#KNN.default_args">default_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PeptideBond">PeptideBond</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PeptideBond.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeptideBond.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeptideBond.default_args">default_args</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../../../bpp.html">bpp</a><wbr>.<a href="./../../../data.html">data</a><wbr>.<a href="./../../graph.html">graph</a><wbr>.<a href="./../construction.html">construction</a><wbr>.edge    </h1>

                
                        <input id="mod-edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-edge-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Literal</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="kn">from</span> <span class="nn">graphein</span> <span class="kn">import</span> <span class="n">protein</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">from</span> <span class="nn">..operator</span> <span class="kn">import</span> <span class="n">EdgeConstructorFunctionOperator</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">from</span> <span class="nn">..operator</span> <span class="kn">import</span> <span class="n">GraphFunction</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="k">class</span> <span class="nc">AromaticSulphur</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_aromatic_sulphur_interactions</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;aromatic_sulphur&quot;</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="k">class</span> <span class="nc">Aromatic</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_aromatic_interactions</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;aromatic&quot;</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="k">class</span> <span class="nc">CationPi</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_cation_pi_interactions</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cation_pi&quot;</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="k">class</span> <span class="nc">Covalent</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">atomic</span><span class="o">.</span><span class="n">add_atomic_edges</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;covalent&quot;</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.56</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="k">class</span> <span class="nc">Delaunay</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_delaunay_triangulation</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;delaunay&quot;</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a><span class="k">class</span> <span class="nc">Disulfide</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_disulfide_interactions</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;disulfide&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a><span class="k">class</span> <span class="nc">HydrogenBond</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_hydrogen_bond_interactions</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hbond&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a><span class="k">class</span> <span class="nc">Ionic</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_ionic_interactions</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a><span class="k">class</span> <span class="nc">KNN</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_k_nn_edges</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;knn&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>    <span class="n">long_interaction_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">63</span></a>    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">64</span></a>    <span class="n">exclude_edges</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;inter&quot;</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">65</span></a>    <span class="n">exclude_self_loops</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos">67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">68</span></a><span class="k">class</span> <span class="nc">PeptideBond</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos">70</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_peptide_bonds</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">71</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;peptide_bond&quot;</span>
</span></pre></div>


            </section>
                <section id="AromaticSulphur">
                            <input id="AromaticSulphur-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AromaticSulphur</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="AromaticSulphur-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AromaticSulphur"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AromaticSulphur-9"><a href="#AromaticSulphur-9"><span class="linenos"> 9</span></a><span class="k">class</span> <span class="nc">AromaticSulphur</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="AromaticSulphur-10"><a href="#AromaticSulphur-10"><span class="linenos">10</span></a>
</span><span id="AromaticSulphur-11"><a href="#AromaticSulphur-11"><span class="linenos">11</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_aromatic_sulphur_interactions</span>
</span><span id="AromaticSulphur-12"><a href="#AromaticSulphur-12"><span class="linenos">12</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;aromatic_sulphur&quot;</span>
</span></pre></div>


    

                            <div id="AromaticSulphur.function" class="classattr">
                                        <input id="AromaticSulphur.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AromaticSulphur.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AromaticSulphur.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AromaticSulphur.function-477"><a href="#AromaticSulphur.function-477"><span class="linenos">477</span></a><span class="k">def</span> <span class="nf">add_aromatic_sulphur_interactions</span><span class="p">(</span>
</span><span id="AromaticSulphur.function-478"><a href="#AromaticSulphur.function-478"><span class="linenos">478</span></a>    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AromaticSulphur.function-479"><a href="#AromaticSulphur.function-479"><span class="linenos">479</span></a><span class="p">):</span>
</span><span id="AromaticSulphur.function-480"><a href="#AromaticSulphur.function-480"><span class="linenos">480</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all aromatic-sulphur interactions.</span>
</span><span id="AromaticSulphur.function-481"><a href="#AromaticSulphur.function-481"><span class="linenos">481</span></a>
</span><span id="AromaticSulphur.function-482"><a href="#AromaticSulphur.function-482"><span class="linenos">482</span></a><span class="sd">    Criteria: Sulphur containing residue () within 5.3 Angstroms of an aromatic</span>
</span><span id="AromaticSulphur.function-483"><a href="#AromaticSulphur.function-483"><span class="linenos">483</span></a><span class="sd">    residue ().</span>
</span><span id="AromaticSulphur.function-484"><a href="#AromaticSulphur.function-484"><span class="linenos">484</span></a>
</span><span id="AromaticSulphur.function-485"><a href="#AromaticSulphur.function-485"><span class="linenos">485</span></a><span class="sd">    :param G: The graph to add the aromatic-sulphur interactions to.</span>
</span><span id="AromaticSulphur.function-486"><a href="#AromaticSulphur.function-486"><span class="linenos">486</span></a><span class="sd">    :type G: nx.Graph</span>
</span><span id="AromaticSulphur.function-487"><a href="#AromaticSulphur.function-487"><span class="linenos">487</span></a><span class="sd">    :param rgroup_df: The rgroup dataframe. If ``None`` (default), the graph&#39;s</span>
</span><span id="AromaticSulphur.function-488"><a href="#AromaticSulphur.function-488"><span class="linenos">488</span></a><span class="sd">        rgroup dataframe is used.</span>
</span><span id="AromaticSulphur.function-489"><a href="#AromaticSulphur.function-489"><span class="linenos">489</span></a><span class="sd">    :type rgroup_df: Optional[pd.DataFrame].</span>
</span><span id="AromaticSulphur.function-490"><a href="#AromaticSulphur.function-490"><span class="linenos">490</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AromaticSulphur.function-491"><a href="#AromaticSulphur.function-491"><span class="linenos">491</span></a>    <span class="k">if</span> <span class="n">rgroup_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AromaticSulphur.function-492"><a href="#AromaticSulphur.function-492"><span class="linenos">492</span></a>        <span class="n">rgroup_df</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;rgroup_df&quot;</span><span class="p">]</span>
</span><span id="AromaticSulphur.function-493"><a href="#AromaticSulphur.function-493"><span class="linenos">493</span></a>    <span class="n">RESIDUES</span> <span class="o">=</span> <span class="n">SULPHUR_RESIS</span> <span class="o">+</span> <span class="n">PI_RESIS</span>
</span><span id="AromaticSulphur.function-494"><a href="#AromaticSulphur.function-494"><span class="linenos">494</span></a>
</span><span id="AromaticSulphur.function-495"><a href="#AromaticSulphur.function-495"><span class="linenos">495</span></a>    <span class="n">aromatic_sulphur_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="AromaticSulphur.function-496"><a href="#AromaticSulphur.function-496"><span class="linenos">496</span></a>        <span class="n">rgroup_df</span><span class="p">,</span> <span class="s2">&quot;residue_name&quot;</span><span class="p">,</span> <span class="n">RESIDUES</span><span class="p">,</span> <span class="kc">True</span>
</span><span id="AromaticSulphur.function-497"><a href="#AromaticSulphur.function-497"><span class="linenos">497</span></a>    <span class="p">)</span>
</span><span id="AromaticSulphur.function-498"><a href="#AromaticSulphur.function-498"><span class="linenos">498</span></a>    <span class="n">aromatic_sulphur_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="AromaticSulphur.function-499"><a href="#AromaticSulphur.function-499"><span class="linenos">499</span></a>        <span class="n">aromatic_sulphur_df</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()),</span> <span class="kc">True</span>
</span><span id="AromaticSulphur.function-500"><a href="#AromaticSulphur.function-500"><span class="linenos">500</span></a>    <span class="p">)</span>
</span><span id="AromaticSulphur.function-501"><a href="#AromaticSulphur.function-501"><span class="linenos">501</span></a>
</span><span id="AromaticSulphur.function-502"><a href="#AromaticSulphur.function-502"><span class="linenos">502</span></a>    <span class="k">if</span> <span class="n">aromatic_sulphur_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AromaticSulphur.function-503"><a href="#AromaticSulphur.function-503"><span class="linenos">503</span></a>        <span class="n">distmat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">aromatic_sulphur_df</span><span class="p">)</span>
</span><span id="AromaticSulphur.function-504"><a href="#AromaticSulphur.function-504"><span class="linenos">504</span></a>        <span class="n">interacting_atoms</span> <span class="o">=</span> <span class="n">get_interacting_atoms</span><span class="p">(</span><span class="mf">5.3</span><span class="p">,</span> <span class="n">distmat</span><span class="p">)</span>
</span><span id="AromaticSulphur.function-505"><a href="#AromaticSulphur.function-505"><span class="linenos">505</span></a>        <span class="n">interacting_atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="AromaticSulphur.function-506"><a href="#AromaticSulphur.function-506"><span class="linenos">506</span></a>            <span class="nb">zip</span><span class="p">(</span><span class="n">interacting_atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">interacting_atoms</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="AromaticSulphur.function-507"><a href="#AromaticSulphur.function-507"><span class="linenos">507</span></a>        <span class="p">)</span>
</span><span id="AromaticSulphur.function-508"><a href="#AromaticSulphur.function-508"><span class="linenos">508</span></a>
</span><span id="AromaticSulphur.function-509"><a href="#AromaticSulphur.function-509"><span class="linenos">509</span></a>        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="n">interacting_atoms</span><span class="p">:</span>
</span><span id="AromaticSulphur.function-510"><a href="#AromaticSulphur.function-510"><span class="linenos">510</span></a>            <span class="n">resi1</span> <span class="o">=</span> <span class="n">aromatic_sulphur_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">]</span>
</span><span id="AromaticSulphur.function-511"><a href="#AromaticSulphur.function-511"><span class="linenos">511</span></a>            <span class="n">resi2</span> <span class="o">=</span> <span class="n">aromatic_sulphur_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a2</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">]</span>
</span><span id="AromaticSulphur.function-512"><a href="#AromaticSulphur.function-512"><span class="linenos">512</span></a>
</span><span id="AromaticSulphur.function-513"><a href="#AromaticSulphur.function-513"><span class="linenos">513</span></a>            <span class="n">condition1</span> <span class="o">=</span> <span class="n">resi1</span> <span class="ow">in</span> <span class="n">SULPHUR_RESIS</span> <span class="ow">and</span> <span class="n">resi2</span> <span class="ow">in</span> <span class="n">PI_RESIS</span>
</span><span id="AromaticSulphur.function-514"><a href="#AromaticSulphur.function-514"><span class="linenos">514</span></a>            <span class="n">condition2</span> <span class="o">=</span> <span class="n">resi1</span> <span class="ow">in</span> <span class="n">PI_RESIS</span> <span class="ow">and</span> <span class="n">resi2</span> <span class="ow">in</span> <span class="n">SULPHUR_RESIS</span>
</span><span id="AromaticSulphur.function-515"><a href="#AromaticSulphur.function-515"><span class="linenos">515</span></a>
</span><span id="AromaticSulphur.function-516"><a href="#AromaticSulphur.function-516"><span class="linenos">516</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">condition1</span> <span class="ow">or</span> <span class="n">condition2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">resi1</span> <span class="o">!=</span> <span class="n">resi2</span><span class="p">:</span>
</span><span id="AromaticSulphur.function-517"><a href="#AromaticSulphur.function-517"><span class="linenos">517</span></a>                <span class="n">add_edge</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">resi1</span><span class="p">,</span> <span class="n">resi2</span><span class="p">,</span> <span class="s2">&quot;aromatic_sulphur&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Find all aromatic-sulphur interactions.</p>

<p>Criteria: Sulphur containing residue () within 5.3 Angstroms of an aromatic
residue ().</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>G</strong>:  The graph to add the aromatic-sulphur interactions to.</li>
<li><strong>rgroup_df</strong>:  The rgroup dataframe. If <code>None</code> (default), the graph's
rgroup dataframe is used.</li>
</ul>
</div>


                            </div>
                            <div id="AromaticSulphur.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;aromatic_sulphur&#39;</span>

        
    </div>
    <a class="headerlink" href="#AromaticSulphur.id"></a>
    
    

                            </div>
                            <div id="AromaticSulphur.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#AromaticSulphur.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="AromaticSulphur.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="AromaticSulphur.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="AromaticSulphur.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="AromaticSulphur.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Aromatic">
                            <input id="Aromatic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Aromatic</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="Aromatic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Aromatic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Aromatic-15"><a href="#Aromatic-15"><span class="linenos">15</span></a><span class="k">class</span> <span class="nc">Aromatic</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="Aromatic-16"><a href="#Aromatic-16"><span class="linenos">16</span></a>
</span><span id="Aromatic-17"><a href="#Aromatic-17"><span class="linenos">17</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_aromatic_interactions</span>
</span><span id="Aromatic-18"><a href="#Aromatic-18"><span class="linenos">18</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;aromatic&quot;</span>
</span></pre></div>


    

                            <div id="Aromatic.function" class="classattr">
                                        <input id="Aromatic.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">pdb_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Aromatic.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Aromatic.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Aromatic.function-420"><a href="#Aromatic.function-420"><span class="linenos">420</span></a><span class="k">def</span> <span class="nf">add_aromatic_interactions</span><span class="p">(</span>
</span><span id="Aromatic.function-421"><a href="#Aromatic.function-421"><span class="linenos">421</span></a>    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">pdb_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Aromatic.function-422"><a href="#Aromatic.function-422"><span class="linenos">422</span></a><span class="p">):</span>
</span><span id="Aromatic.function-423"><a href="#Aromatic.function-423"><span class="linenos">423</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Aromatic.function-424"><a href="#Aromatic.function-424"><span class="linenos">424</span></a><span class="sd">    Find all aromatic-aromatic interaction.</span>
</span><span id="Aromatic.function-425"><a href="#Aromatic.function-425"><span class="linenos">425</span></a>
</span><span id="Aromatic.function-426"><a href="#Aromatic.function-426"><span class="linenos">426</span></a><span class="sd">    Criteria: phenyl ring centroids separated between 4.5A to 7A.</span>
</span><span id="Aromatic.function-427"><a href="#Aromatic.function-427"><span class="linenos">427</span></a><span class="sd">    Phenyl rings are present on ``PHE, TRP, HIS, TYR``</span>
</span><span id="Aromatic.function-428"><a href="#Aromatic.function-428"><span class="linenos">428</span></a><span class="sd">    (:const:`~graphein.protein.resi_atoms.AROMATIC_RESIS`).</span>
</span><span id="Aromatic.function-429"><a href="#Aromatic.function-429"><span class="linenos">429</span></a><span class="sd">    Phenyl ring atoms on these amino acids are defined by the following</span>
</span><span id="Aromatic.function-430"><a href="#Aromatic.function-430"><span class="linenos">430</span></a><span class="sd">    atoms:</span>
</span><span id="Aromatic.function-431"><a href="#Aromatic.function-431"><span class="linenos">431</span></a><span class="sd">    - PHE: CG, CD, CE, CZ</span>
</span><span id="Aromatic.function-432"><a href="#Aromatic.function-432"><span class="linenos">432</span></a><span class="sd">    - TRP: CD, CE, CH, CZ</span>
</span><span id="Aromatic.function-433"><a href="#Aromatic.function-433"><span class="linenos">433</span></a><span class="sd">    - HIS: CG, CD, ND, NE, CE</span>
</span><span id="Aromatic.function-434"><a href="#Aromatic.function-434"><span class="linenos">434</span></a><span class="sd">    - TYR: CG, CD, CE, CZ</span>
</span><span id="Aromatic.function-435"><a href="#Aromatic.function-435"><span class="linenos">435</span></a><span class="sd">    Centroids of these atoms are taken by taking:</span>
</span><span id="Aromatic.function-436"><a href="#Aromatic.function-436"><span class="linenos">436</span></a><span class="sd">        (mean x), (mean y), (mean z)</span>
</span><span id="Aromatic.function-437"><a href="#Aromatic.function-437"><span class="linenos">437</span></a><span class="sd">    for each of the ring atoms.</span>
</span><span id="Aromatic.function-438"><a href="#Aromatic.function-438"><span class="linenos">438</span></a><span class="sd">    Notes for future self/developers:</span>
</span><span id="Aromatic.function-439"><a href="#Aromatic.function-439"><span class="linenos">439</span></a><span class="sd">    - Because of the requirement to pre-compute ring centroids, we do not</span>
</span><span id="Aromatic.function-440"><a href="#Aromatic.function-440"><span class="linenos">440</span></a><span class="sd">        use the functions written above (filter_dataframe, compute_distmat,</span>
</span><span id="Aromatic.function-441"><a href="#Aromatic.function-441"><span class="linenos">441</span></a><span class="sd">        get_interacting_atoms), as they do not return centroid atom</span>
</span><span id="Aromatic.function-442"><a href="#Aromatic.function-442"><span class="linenos">442</span></a><span class="sd">        euclidean coordinates.</span>
</span><span id="Aromatic.function-443"><a href="#Aromatic.function-443"><span class="linenos">443</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Aromatic.function-444"><a href="#Aromatic.function-444"><span class="linenos">444</span></a>    <span class="k">if</span> <span class="n">pdb_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Aromatic.function-445"><a href="#Aromatic.function-445"><span class="linenos">445</span></a>        <span class="n">pdb_df</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;raw_pdb_df&quot;</span><span class="p">]</span>
</span><span id="Aromatic.function-446"><a href="#Aromatic.function-446"><span class="linenos">446</span></a>    <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Aromatic.function-447"><a href="#Aromatic.function-447"><span class="linenos">447</span></a>    <span class="k">for</span> <span class="n">resi</span> <span class="ow">in</span> <span class="n">AROMATIC_RESIS</span><span class="p">:</span>
</span><span id="Aromatic.function-448"><a href="#Aromatic.function-448"><span class="linenos">448</span></a>        <span class="n">resi_rings_df</span> <span class="o">=</span> <span class="n">get_ring_atoms</span><span class="p">(</span><span class="n">pdb_df</span><span class="p">,</span> <span class="n">resi</span><span class="p">)</span>
</span><span id="Aromatic.function-449"><a href="#Aromatic.function-449"><span class="linenos">449</span></a>        <span class="n">resi_rings_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="Aromatic.function-450"><a href="#Aromatic.function-450"><span class="linenos">450</span></a>            <span class="n">resi_rings_df</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()),</span> <span class="kc">True</span>
</span><span id="Aromatic.function-451"><a href="#Aromatic.function-451"><span class="linenos">451</span></a>        <span class="p">)</span>
</span><span id="Aromatic.function-452"><a href="#Aromatic.function-452"><span class="linenos">452</span></a>        <span class="n">resi_centroid_df</span> <span class="o">=</span> <span class="n">get_ring_centroids</span><span class="p">(</span><span class="n">resi_rings_df</span><span class="p">)</span>
</span><span id="Aromatic.function-453"><a href="#Aromatic.function-453"><span class="linenos">453</span></a>        <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resi_centroid_df</span><span class="p">)</span>
</span><span id="Aromatic.function-454"><a href="#Aromatic.function-454"><span class="linenos">454</span></a>    <span class="n">aromatic_df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Aromatic.function-455"><a href="#Aromatic.function-455"><span class="linenos">455</span></a>        <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;node_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Aromatic.function-456"><a href="#Aromatic.function-456"><span class="linenos">456</span></a>    <span class="p">)</span>
</span><span id="Aromatic.function-457"><a href="#Aromatic.function-457"><span class="linenos">457</span></a>    <span class="k">if</span> <span class="n">aromatic_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Aromatic.function-458"><a href="#Aromatic.function-458"><span class="linenos">458</span></a>        <span class="n">distmat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">aromatic_df</span><span class="p">)</span>
</span><span id="Aromatic.function-459"><a href="#Aromatic.function-459"><span class="linenos">459</span></a>        <span class="n">distmat</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">aromatic_df</span><span class="p">[</span><span class="s2">&quot;node_id&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Aromatic.function-460"><a href="#Aromatic.function-460"><span class="linenos">460</span></a>        <span class="n">distmat</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">aromatic_df</span><span class="p">[</span><span class="s2">&quot;node_id&quot;</span><span class="p">]</span>
</span><span id="Aromatic.function-461"><a href="#Aromatic.function-461"><span class="linenos">461</span></a>        <span class="n">distmat</span> <span class="o">=</span> <span class="n">distmat</span><span class="p">[(</span><span class="n">distmat</span> <span class="o">&gt;=</span> <span class="mf">4.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">distmat</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Aromatic.function-462"><a href="#Aromatic.function-462"><span class="linenos">462</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">distmat</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Aromatic.function-463"><a href="#Aromatic.function-463"><span class="linenos">463</span></a>
</span><span id="Aromatic.function-464"><a href="#Aromatic.function-464"><span class="linenos">464</span></a>        <span class="n">interacting_resis</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Aromatic.function-465"><a href="#Aromatic.function-465"><span class="linenos">465</span></a>            <span class="p">(</span><span class="n">distmat</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">distmat</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
</span><span id="Aromatic.function-466"><a href="#Aromatic.function-466"><span class="linenos">466</span></a>            <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Aromatic.function-467"><a href="#Aromatic.function-467"><span class="linenos">467</span></a>        <span class="p">]</span>
</span><span id="Aromatic.function-468"><a href="#Aromatic.function-468"><span class="linenos">468</span></a>        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="Aromatic.function-469"><a href="#Aromatic.function-469"><span class="linenos">469</span></a>            <span class="sa">f</span><span class="s2">&quot;Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">interacting_resis</span><span class="p">)</span><span class="si">}</span><span class="s2"> aromatic-aromatic interactions&quot;</span>
</span><span id="Aromatic.function-470"><a href="#Aromatic.function-470"><span class="linenos">470</span></a>        <span class="p">)</span>
</span><span id="Aromatic.function-471"><a href="#Aromatic.function-471"><span class="linenos">471</span></a>        <span class="k">for</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="ow">in</span> <span class="n">interacting_resis</span><span class="p">:</span>
</span><span id="Aromatic.function-472"><a href="#Aromatic.function-472"><span class="linenos">472</span></a>            <span class="k">assert</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n1</span><span class="p">][</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">AROMATIC_RESIS</span>
</span><span id="Aromatic.function-473"><a href="#Aromatic.function-473"><span class="linenos">473</span></a>            <span class="k">assert</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n2</span><span class="p">][</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">AROMATIC_RESIS</span>
</span><span id="Aromatic.function-474"><a href="#Aromatic.function-474"><span class="linenos">474</span></a>            <span class="n">add_edge</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="s2">&quot;aromatic&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Find all aromatic-aromatic interaction.</p>

<p>Criteria: phenyl ring centroids separated between 4.5A to 7A.
Phenyl rings are present on <code>PHE, TRP, HIS, TYR</code>
(<code>~graphein.protein.resi_atoms.AROMATIC_RESIS</code>).
Phenyl ring atoms on these amino acids are defined by the following
atoms:</p>

<ul>
<li>PHE: CG, CD, CE, CZ</li>
<li>TRP: CD, CE, CH, CZ</li>
<li>HIS: CG, CD, ND, NE, CE</li>
<li>TYR: CG, CD, CE, CZ</li>
</ul>

<h6 id="centroids-of-these-atoms-are-taken-by-taking">Centroids of these atoms are taken by taking:</h6>

<blockquote>
  <p>(mean x), (mean y), (mean z)</p>
</blockquote>

<p>for each of the ring atoms.
Notes for future self/developers:</p>

<ul>
<li>Because of the requirement to pre-compute ring centroids, we do not
use the functions written above (filter_dataframe, compute_distmat,
get_interacting_atoms), as they do not return centroid atom
euclidean coordinates.</li>
</ul>
</div>


                            </div>
                            <div id="Aromatic.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;aromatic&#39;</span>

        
    </div>
    <a class="headerlink" href="#Aromatic.id"></a>
    
    

                            </div>
                            <div id="Aromatic.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#Aromatic.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="Aromatic.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="Aromatic.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="Aromatic.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="Aromatic.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CationPi">
                            <input id="CationPi-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CationPi</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="CationPi-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CationPi"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CationPi-21"><a href="#CationPi-21"><span class="linenos">21</span></a><span class="k">class</span> <span class="nc">CationPi</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="CationPi-22"><a href="#CationPi-22"><span class="linenos">22</span></a>
</span><span id="CationPi-23"><a href="#CationPi-23"><span class="linenos">23</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_cation_pi_interactions</span>
</span><span id="CationPi-24"><a href="#CationPi-24"><span class="linenos">24</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cation_pi&quot;</span>
</span></pre></div>


    

                            <div id="CationPi.function" class="classattr">
                                        <input id="CationPi.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CationPi.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CationPi.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CationPi.function-520"><a href="#CationPi.function-520"><span class="linenos">520</span></a><span class="k">def</span> <span class="nf">add_cation_pi_interactions</span><span class="p">(</span>
</span><span id="CationPi.function-521"><a href="#CationPi.function-521"><span class="linenos">521</span></a>    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CationPi.function-522"><a href="#CationPi.function-522"><span class="linenos">522</span></a><span class="p">):</span>
</span><span id="CationPi.function-523"><a href="#CationPi.function-523"><span class="linenos">523</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add cation-pi interactions.</span>
</span><span id="CationPi.function-524"><a href="#CationPi.function-524"><span class="linenos">524</span></a>
</span><span id="CationPi.function-525"><a href="#CationPi.function-525"><span class="linenos">525</span></a><span class="sd">    Criteria:</span>
</span><span id="CationPi.function-526"><a href="#CationPi.function-526"><span class="linenos">526</span></a><span class="sd">        # Todo</span>
</span><span id="CationPi.function-527"><a href="#CationPi.function-527"><span class="linenos">527</span></a>
</span><span id="CationPi.function-528"><a href="#CationPi.function-528"><span class="linenos">528</span></a><span class="sd">    :param G: Graph to add cation-pi interactions to.</span>
</span><span id="CationPi.function-529"><a href="#CationPi.function-529"><span class="linenos">529</span></a><span class="sd">    :type G: nx.Graph</span>
</span><span id="CationPi.function-530"><a href="#CationPi.function-530"><span class="linenos">530</span></a><span class="sd">    :param rgroup_df: Dataframe containing rgroup information. Defaults to</span>
</span><span id="CationPi.function-531"><a href="#CationPi.function-531"><span class="linenos">531</span></a><span class="sd">        ``None``.</span>
</span><span id="CationPi.function-532"><a href="#CationPi.function-532"><span class="linenos">532</span></a><span class="sd">    :type rgroup_df: Optional[pd.DataFrame].</span>
</span><span id="CationPi.function-533"><a href="#CationPi.function-533"><span class="linenos">533</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CationPi.function-534"><a href="#CationPi.function-534"><span class="linenos">534</span></a>    <span class="k">if</span> <span class="n">rgroup_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CationPi.function-535"><a href="#CationPi.function-535"><span class="linenos">535</span></a>        <span class="n">rgroup_df</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;rgroup_df&quot;</span><span class="p">]</span>
</span><span id="CationPi.function-536"><a href="#CationPi.function-536"><span class="linenos">536</span></a>    <span class="n">cation_pi_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="CationPi.function-537"><a href="#CationPi.function-537"><span class="linenos">537</span></a>        <span class="n">rgroup_df</span><span class="p">,</span> <span class="s2">&quot;residue_name&quot;</span><span class="p">,</span> <span class="n">CATION_PI_RESIS</span><span class="p">,</span> <span class="kc">True</span>
</span><span id="CationPi.function-538"><a href="#CationPi.function-538"><span class="linenos">538</span></a>    <span class="p">)</span>
</span><span id="CationPi.function-539"><a href="#CationPi.function-539"><span class="linenos">539</span></a>    <span class="n">cation_pi_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="CationPi.function-540"><a href="#CationPi.function-540"><span class="linenos">540</span></a>        <span class="n">cation_pi_df</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()),</span> <span class="kc">True</span>
</span><span id="CationPi.function-541"><a href="#CationPi.function-541"><span class="linenos">541</span></a>    <span class="p">)</span>
</span><span id="CationPi.function-542"><a href="#CationPi.function-542"><span class="linenos">542</span></a>
</span><span id="CationPi.function-543"><a href="#CationPi.function-543"><span class="linenos">543</span></a>    <span class="k">if</span> <span class="n">cation_pi_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CationPi.function-544"><a href="#CationPi.function-544"><span class="linenos">544</span></a>        <span class="n">distmat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">cation_pi_df</span><span class="p">)</span>
</span><span id="CationPi.function-545"><a href="#CationPi.function-545"><span class="linenos">545</span></a>        <span class="n">interacting_atoms</span> <span class="o">=</span> <span class="n">get_interacting_atoms</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">distmat</span><span class="p">)</span>
</span><span id="CationPi.function-546"><a href="#CationPi.function-546"><span class="linenos">546</span></a>        <span class="n">interacting_atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="CationPi.function-547"><a href="#CationPi.function-547"><span class="linenos">547</span></a>            <span class="nb">zip</span><span class="p">(</span><span class="n">interacting_atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">interacting_atoms</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="CationPi.function-548"><a href="#CationPi.function-548"><span class="linenos">548</span></a>        <span class="p">)</span>
</span><span id="CationPi.function-549"><a href="#CationPi.function-549"><span class="linenos">549</span></a>
</span><span id="CationPi.function-550"><a href="#CationPi.function-550"><span class="linenos">550</span></a>        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="n">interacting_atoms</span><span class="p">:</span>
</span><span id="CationPi.function-551"><a href="#CationPi.function-551"><span class="linenos">551</span></a>            <span class="n">resi1</span> <span class="o">=</span> <span class="n">cation_pi_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">]</span>
</span><span id="CationPi.function-552"><a href="#CationPi.function-552"><span class="linenos">552</span></a>            <span class="n">resi2</span> <span class="o">=</span> <span class="n">cation_pi_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a2</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">]</span>
</span><span id="CationPi.function-553"><a href="#CationPi.function-553"><span class="linenos">553</span></a>
</span><span id="CationPi.function-554"><a href="#CationPi.function-554"><span class="linenos">554</span></a>            <span class="n">condition1</span> <span class="o">=</span> <span class="n">resi1</span> <span class="ow">in</span> <span class="n">CATION_RESIS</span> <span class="ow">and</span> <span class="n">resi2</span> <span class="ow">in</span> <span class="n">PI_RESIS</span>
</span><span id="CationPi.function-555"><a href="#CationPi.function-555"><span class="linenos">555</span></a>            <span class="n">condition2</span> <span class="o">=</span> <span class="n">resi1</span> <span class="ow">in</span> <span class="n">PI_RESIS</span> <span class="ow">and</span> <span class="n">resi2</span> <span class="ow">in</span> <span class="n">CATION_RESIS</span>
</span><span id="CationPi.function-556"><a href="#CationPi.function-556"><span class="linenos">556</span></a>
</span><span id="CationPi.function-557"><a href="#CationPi.function-557"><span class="linenos">557</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">condition1</span> <span class="ow">or</span> <span class="n">condition2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">resi1</span> <span class="o">!=</span> <span class="n">resi2</span><span class="p">:</span>
</span><span id="CationPi.function-558"><a href="#CationPi.function-558"><span class="linenos">558</span></a>                <span class="n">add_edge</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">resi1</span><span class="p">,</span> <span class="n">resi2</span><span class="p">,</span> <span class="s2">&quot;cation_pi&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add cation-pi interactions.</p>

<h6 id="criteria">Criteria:</h6>

<blockquote>
  <h1 id="todo">Todo</h1>
</blockquote>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>G</strong>:  Graph to add cation-pi interactions to.</li>
<li><strong>rgroup_df</strong>:  Dataframe containing rgroup information. Defaults to
<code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="CationPi.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;cation_pi&#39;</span>

        
    </div>
    <a class="headerlink" href="#CationPi.id"></a>
    
    

                            </div>
                            <div id="CationPi.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#CationPi.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="CationPi.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="CationPi.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="CationPi.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="CationPi.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Covalent">
                            <input id="Covalent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Covalent</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="Covalent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Covalent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Covalent-27"><a href="#Covalent-27"><span class="linenos">27</span></a><span class="k">class</span> <span class="nc">Covalent</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="Covalent-28"><a href="#Covalent-28"><span class="linenos">28</span></a>
</span><span id="Covalent-29"><a href="#Covalent-29"><span class="linenos">29</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">atomic</span><span class="o">.</span><span class="n">add_atomic_edges</span>
</span><span id="Covalent-30"><a href="#Covalent-30"><span class="linenos">30</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;covalent&quot;</span>
</span><span id="Covalent-31"><a href="#Covalent-31"><span class="linenos">31</span></a>
</span><span id="Covalent-32"><a href="#Covalent-32"><span class="linenos">32</span></a>    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.56</span>
</span></pre></div>


    

                            <div id="Covalent.function" class="classattr">
                                        <input id="Covalent.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.56</span></span><span class="return-annotation">) -> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>:</span></span>

                <label class="view-source-button" for="Covalent.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Covalent.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Covalent.function-95"><a href="#Covalent.function-95"><span class="linenos"> 95</span></a><span class="k">def</span> <span class="nf">add_atomic_edges</span><span class="p">(</span><span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.56</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
</span><span id="Covalent.function-96"><a href="#Covalent.function-96"><span class="linenos"> 96</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Covalent.function-97"><a href="#Covalent.function-97"><span class="linenos"> 97</span></a><span class="sd">    Computes covalent edges based on atomic distances. Covalent radii are</span>
</span><span id="Covalent.function-98"><a href="#Covalent.function-98"><span class="linenos"> 98</span></a><span class="sd">    assigned to each atom based on its bond assign_bond_states_to_dataframe.</span>
</span><span id="Covalent.function-99"><a href="#Covalent.function-99"><span class="linenos"> 99</span></a><span class="sd">    The distance matrix is then thresholded to entries less than this distance</span>
</span><span id="Covalent.function-100"><a href="#Covalent.function-100"><span class="linenos">100</span></a><span class="sd">    plus some tolerance to create an adjacency matrix. This adjacency matrix is</span>
</span><span id="Covalent.function-101"><a href="#Covalent.function-101"><span class="linenos">101</span></a><span class="sd">    then parsed into an edge list and covalent edges added</span>
</span><span id="Covalent.function-102"><a href="#Covalent.function-102"><span class="linenos">102</span></a>
</span><span id="Covalent.function-103"><a href="#Covalent.function-103"><span class="linenos">103</span></a><span class="sd">    :param G: Atomic graph (nodes correspond to atoms) to populate with atomic</span>
</span><span id="Covalent.function-104"><a href="#Covalent.function-104"><span class="linenos">104</span></a><span class="sd">        bonds as edges</span>
</span><span id="Covalent.function-105"><a href="#Covalent.function-105"><span class="linenos">105</span></a><span class="sd">    :type G: nx.Graph</span>
</span><span id="Covalent.function-106"><a href="#Covalent.function-106"><span class="linenos">106</span></a><span class="sd">    :param tolerance: Tolerance for atomic distance. Default is ``0.56``</span>
</span><span id="Covalent.function-107"><a href="#Covalent.function-107"><span class="linenos">107</span></a><span class="sd">        Angstroms. Commonly used values are: ``0.4, 0.45, 0.56``</span>
</span><span id="Covalent.function-108"><a href="#Covalent.function-108"><span class="linenos">108</span></a><span class="sd">    :type tolerance: float</span>
</span><span id="Covalent.function-109"><a href="#Covalent.function-109"><span class="linenos">109</span></a><span class="sd">    :return: Atomic graph with edges between bonded atoms added</span>
</span><span id="Covalent.function-110"><a href="#Covalent.function-110"><span class="linenos">110</span></a><span class="sd">    :rtype: nx.Graph</span>
</span><span id="Covalent.function-111"><a href="#Covalent.function-111"><span class="linenos">111</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Covalent.function-112"><a href="#Covalent.function-112"><span class="linenos">112</span></a>    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">])</span>
</span><span id="Covalent.function-113"><a href="#Covalent.function-113"><span class="linenos">113</span></a>
</span><span id="Covalent.function-114"><a href="#Covalent.function-114"><span class="linenos">114</span></a>    <span class="c1"># We assign bond states to the dataframe, and then map these to covalent</span>
</span><span id="Covalent.function-115"><a href="#Covalent.function-115"><span class="linenos">115</span></a>    <span class="c1"># radii</span>
</span><span id="Covalent.function-116"><a href="#Covalent.function-116"><span class="linenos">116</span></a>    <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">assign_bond_states_to_dataframe</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">])</span>
</span><span id="Covalent.function-117"><a href="#Covalent.function-117"><span class="linenos">117</span></a>    <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">assign_covalent_radii_to_dataframe</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">])</span>
</span><span id="Covalent.function-118"><a href="#Covalent.function-118"><span class="linenos">118</span></a>
</span><span id="Covalent.function-119"><a href="#Covalent.function-119"><span class="linenos">119</span></a>    <span class="c1"># Create a covalent &#39;distance&#39; matrix by adding the radius arrays with its</span>
</span><span id="Covalent.function-120"><a href="#Covalent.function-120"><span class="linenos">120</span></a>    <span class="c1"># transpose</span>
</span><span id="Covalent.function-121"><a href="#Covalent.function-121"><span class="linenos">121</span></a>    <span class="n">covalent_radius_distance_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
</span><span id="Covalent.function-122"><a href="#Covalent.function-122"><span class="linenos">122</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">][</span><span class="s2">&quot;covalent_radius&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="Covalent.function-123"><a href="#Covalent.function-123"><span class="linenos">123</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">][</span><span class="s2">&quot;covalent_radius&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
</span><span id="Covalent.function-124"><a href="#Covalent.function-124"><span class="linenos">124</span></a>    <span class="p">)</span>
</span><span id="Covalent.function-125"><a href="#Covalent.function-125"><span class="linenos">125</span></a>
</span><span id="Covalent.function-126"><a href="#Covalent.function-126"><span class="linenos">126</span></a>    <span class="c1"># Add the tolerance</span>
</span><span id="Covalent.function-127"><a href="#Covalent.function-127"><span class="linenos">127</span></a>    <span class="n">covalent_radius_distance_matrix</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Covalent.function-128"><a href="#Covalent.function-128"><span class="linenos">128</span></a>        <span class="n">covalent_radius_distance_matrix</span> <span class="o">+</span> <span class="n">tolerance</span>
</span><span id="Covalent.function-129"><a href="#Covalent.function-129"><span class="linenos">129</span></a>    <span class="p">)</span>
</span><span id="Covalent.function-130"><a href="#Covalent.function-130"><span class="linenos">130</span></a>
</span><span id="Covalent.function-131"><a href="#Covalent.function-131"><span class="linenos">131</span></a>    <span class="c1"># Threshold Distance Matrix to entries where the eucl distance is less than</span>
</span><span id="Covalent.function-132"><a href="#Covalent.function-132"><span class="linenos">132</span></a>    <span class="c1"># the covalent radius plus tolerance and larger than 0.4</span>
</span><span id="Covalent.function-133"><a href="#Covalent.function-133"><span class="linenos">133</span></a>    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">dist_mat</span><span class="p">[</span><span class="n">dist_mat</span> <span class="o">&gt;</span> <span class="mf">0.4</span><span class="p">]</span>
</span><span id="Covalent.function-134"><a href="#Covalent.function-134"><span class="linenos">134</span></a>    <span class="n">t_distmat</span> <span class="o">=</span> <span class="n">dist_mat</span><span class="p">[</span><span class="n">dist_mat</span> <span class="o">&lt;</span> <span class="n">covalent_radius_distance_matrix</span><span class="p">]</span>
</span><span id="Covalent.function-135"><a href="#Covalent.function-135"><span class="linenos">135</span></a>
</span><span id="Covalent.function-136"><a href="#Covalent.function-136"><span class="linenos">136</span></a>    <span class="c1"># Store atomic adjacency matrix in graph</span>
</span><span id="Covalent.function-137"><a href="#Covalent.function-137"><span class="linenos">137</span></a>    <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;atomic_adj_mat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">t_distmat</span><span class="p">)</span>
</span><span id="Covalent.function-138"><a href="#Covalent.function-138"><span class="linenos">138</span></a>
</span><span id="Covalent.function-139"><a href="#Covalent.function-139"><span class="linenos">139</span></a>    <span class="c1"># Get node IDs from non NaN entries in the thresholded distance matrix and</span>
</span><span id="Covalent.function-140"><a href="#Covalent.function-140"><span class="linenos">140</span></a>    <span class="c1"># add the edge to the graph</span>
</span><span id="Covalent.function-141"><a href="#Covalent.function-141"><span class="linenos">141</span></a>    <span class="n">inds</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">t_distmat</span><span class="p">)))</span>
</span><span id="Covalent.function-142"><a href="#Covalent.function-142"><span class="linenos">142</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">:</span>
</span><span id="Covalent.function-143"><a href="#Covalent.function-143"><span class="linenos">143</span></a>        <span class="n">length</span> <span class="o">=</span> <span class="n">t_distmat</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="Covalent.function-144"><a href="#Covalent.function-144"><span class="linenos">144</span></a>        <span class="n">node_1</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">][</span><span class="s2">&quot;node_id&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Covalent.function-145"><a href="#Covalent.function-145"><span class="linenos">145</span></a>        <span class="n">node_2</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">][</span><span class="s2">&quot;node_id&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="Covalent.function-146"><a href="#Covalent.function-146"><span class="linenos">146</span></a>        <span class="n">chain_1</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">][</span><span class="s2">&quot;chain_id&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Covalent.function-147"><a href="#Covalent.function-147"><span class="linenos">147</span></a>        <span class="n">chain_2</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">][</span><span class="s2">&quot;chain_id&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="Covalent.function-148"><a href="#Covalent.function-148"><span class="linenos">148</span></a>
</span><span id="Covalent.function-149"><a href="#Covalent.function-149"><span class="linenos">149</span></a>        <span class="c1"># Check nodes are in graph</span>
</span><span id="Covalent.function-150"><a href="#Covalent.function-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">has_node</span><span class="p">(</span><span class="n">node_1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">G</span><span class="o">.</span><span class="n">has_node</span><span class="p">(</span><span class="n">node_2</span><span class="p">)):</span>
</span><span id="Covalent.function-151"><a href="#Covalent.function-151"><span class="linenos">151</span></a>            <span class="k">continue</span>
</span><span id="Covalent.function-152"><a href="#Covalent.function-152"><span class="linenos">152</span></a>
</span><span id="Covalent.function-153"><a href="#Covalent.function-153"><span class="linenos">153</span></a>        <span class="c1"># Check atoms are in the same chain</span>
</span><span id="Covalent.function-154"><a href="#Covalent.function-154"><span class="linenos">154</span></a>        <span class="k">if</span> <span class="n">chain_1</span> <span class="o">!=</span> <span class="n">chain_2</span><span class="p">:</span>
</span><span id="Covalent.function-155"><a href="#Covalent.function-155"><span class="linenos">155</span></a>            <span class="k">continue</span>
</span><span id="Covalent.function-156"><a href="#Covalent.function-156"><span class="linenos">156</span></a>
</span><span id="Covalent.function-157"><a href="#Covalent.function-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="n">G</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">node_1</span><span class="p">,</span> <span class="n">node_2</span><span class="p">):</span>
</span><span id="Covalent.function-158"><a href="#Covalent.function-158"><span class="linenos">158</span></a>            <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node_1</span><span class="p">,</span> <span class="n">node_2</span><span class="p">][</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;covalent&quot;</span><span class="p">)</span>
</span><span id="Covalent.function-159"><a href="#Covalent.function-159"><span class="linenos">159</span></a>            <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node_1</span><span class="p">,</span> <span class="n">node_2</span><span class="p">][</span><span class="s2">&quot;bond_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">length</span>
</span><span id="Covalent.function-160"><a href="#Covalent.function-160"><span class="linenos">160</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Covalent.function-161"><a href="#Covalent.function-161"><span class="linenos">161</span></a>            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node_1</span><span class="p">,</span> <span class="n">node_2</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;covalent&quot;</span><span class="p">},</span> <span class="n">bond_length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>
</span><span id="Covalent.function-162"><a href="#Covalent.function-162"><span class="linenos">162</span></a>
</span><span id="Covalent.function-163"><a href="#Covalent.function-163"><span class="linenos">163</span></a>    <span class="c1"># Todo checking degree against MAX_NEIGHBOURS</span>
</span><span id="Covalent.function-164"><a href="#Covalent.function-164"><span class="linenos">164</span></a>
</span><span id="Covalent.function-165"><a href="#Covalent.function-165"><span class="linenos">165</span></a>    <span class="k">return</span> <span class="n">G</span>
</span></pre></div>


            <div class="docstring"><p>Computes covalent edges based on atomic distances. Covalent radii are
assigned to each atom based on its bond assign_bond_states_to_dataframe.
The distance matrix is then thresholded to entries less than this distance
plus some tolerance to create an adjacency matrix. This adjacency matrix is
then parsed into an edge list and covalent edges added</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>G</strong>:  Atomic graph (nodes correspond to atoms) to populate with atomic
bonds as edges</li>
<li><strong>tolerance</strong>:  Tolerance for atomic distance. Default is <code>0.56</code>
Angstroms. Commonly used values are: <code>0.4, 0.45, 0.56</code></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Atomic graph with edges between bonded atoms added</p>
</blockquote>
</div>


                            </div>
                            <div id="Covalent.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;covalent&#39;</span>

        
    </div>
    <a class="headerlink" href="#Covalent.id"></a>
    
    

                            </div>
                            <div id="Covalent.tolerance" class="classattr">
                                <div class="attr variable">
            <span class="name">tolerance</span><span class="annotation">: float</span>        =
<span class="default_value">0.56</span>

        
    </div>
    <a class="headerlink" href="#Covalent.tolerance"></a>
    
    

                            </div>
                            <div id="Covalent.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{&#39;tolerance&#39;: 0.56}</span>

        
    </div>
    <a class="headerlink" href="#Covalent.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="Covalent.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="Covalent.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="Covalent.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="Covalent.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Delaunay">
                            <input id="Delaunay-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Delaunay</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="Delaunay-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Delaunay"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Delaunay-35"><a href="#Delaunay-35"><span class="linenos">35</span></a><span class="k">class</span> <span class="nc">Delaunay</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="Delaunay-36"><a href="#Delaunay-36"><span class="linenos">36</span></a>
</span><span id="Delaunay-37"><a href="#Delaunay-37"><span class="linenos">37</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_delaunay_triangulation</span>
</span><span id="Delaunay-38"><a href="#Delaunay-38"><span class="linenos">38</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;delaunay&quot;</span>
</span></pre></div>


    

                            <div id="Delaunay.function" class="classattr">
                                        <input id="Delaunay.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">allowable_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Delaunay.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Delaunay.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Delaunay.function-880"><a href="#Delaunay.function-880"><span class="linenos">880</span></a><span class="k">def</span> <span class="nf">add_delaunay_triangulation</span><span class="p">(</span>
</span><span id="Delaunay.function-881"><a href="#Delaunay.function-881"><span class="linenos">881</span></a>    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">allowable_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Delaunay.function-882"><a href="#Delaunay.function-882"><span class="linenos">882</span></a><span class="p">):</span>
</span><span id="Delaunay.function-883"><a href="#Delaunay.function-883"><span class="linenos">883</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Delaunay.function-884"><a href="#Delaunay.function-884"><span class="linenos">884</span></a><span class="sd">    Compute the Delaunay triangulation of the protein structure.</span>
</span><span id="Delaunay.function-885"><a href="#Delaunay.function-885"><span class="linenos">885</span></a>
</span><span id="Delaunay.function-886"><a href="#Delaunay.function-886"><span class="linenos">886</span></a><span class="sd">    This has been used in prior work. References:</span>
</span><span id="Delaunay.function-887"><a href="#Delaunay.function-887"><span class="linenos">887</span></a>
</span><span id="Delaunay.function-888"><a href="#Delaunay.function-888"><span class="linenos">888</span></a><span class="sd">        Harrison, R. W., Yu, X. &amp; Weber, I. T. Using triangulation to include</span>
</span><span id="Delaunay.function-889"><a href="#Delaunay.function-889"><span class="linenos">889</span></a><span class="sd">        target structure improves drug resistance prediction accuracy. in 11</span>
</span><span id="Delaunay.function-890"><a href="#Delaunay.function-890"><span class="linenos">890</span></a><span class="sd">        (IEEE, 2013). doi:10.1109/ICCABS.2013.6629236</span>
</span><span id="Delaunay.function-891"><a href="#Delaunay.function-891"><span class="linenos">891</span></a>
</span><span id="Delaunay.function-892"><a href="#Delaunay.function-892"><span class="linenos">892</span></a><span class="sd">        Yu, X., Weber, I. T. &amp; Harrison, R. W. Prediction of HIV drug</span>
</span><span id="Delaunay.function-893"><a href="#Delaunay.function-893"><span class="linenos">893</span></a><span class="sd">        resistance from genotype with encoded three-dimensional protein</span>
</span><span id="Delaunay.function-894"><a href="#Delaunay.function-894"><span class="linenos">894</span></a><span class="sd">        structure. BMC Genomics 15 Suppl 5, S1 (2014).</span>
</span><span id="Delaunay.function-895"><a href="#Delaunay.function-895"><span class="linenos">895</span></a>
</span><span id="Delaunay.function-896"><a href="#Delaunay.function-896"><span class="linenos">896</span></a><span class="sd">    Notes:</span>
</span><span id="Delaunay.function-897"><a href="#Delaunay.function-897"><span class="linenos">897</span></a><span class="sd">    1. We do not use the add_interacting_resis function, because this</span>
</span><span id="Delaunay.function-898"><a href="#Delaunay.function-898"><span class="linenos">898</span></a><span class="sd">        interaction is computed on the ``CA`` atoms. Therefore, there is code</span>
</span><span id="Delaunay.function-899"><a href="#Delaunay.function-899"><span class="linenos">899</span></a><span class="sd">        duplication. For now, I have chosen to leave this code duplication</span>
</span><span id="Delaunay.function-900"><a href="#Delaunay.function-900"><span class="linenos">900</span></a><span class="sd">        in.</span>
</span><span id="Delaunay.function-901"><a href="#Delaunay.function-901"><span class="linenos">901</span></a>
</span><span id="Delaunay.function-902"><a href="#Delaunay.function-902"><span class="linenos">902</span></a><span class="sd">    :param G: The networkx graph to add the triangulation to.</span>
</span><span id="Delaunay.function-903"><a href="#Delaunay.function-903"><span class="linenos">903</span></a><span class="sd">    :type G: nx.Graph</span>
</span><span id="Delaunay.function-904"><a href="#Delaunay.function-904"><span class="linenos">904</span></a><span class="sd">    :param allowable_nodes: The nodes to include in the triangulation.</span>
</span><span id="Delaunay.function-905"><a href="#Delaunay.function-905"><span class="linenos">905</span></a><span class="sd">        If ``None`` (default), no filtering is done. This parameter is used to</span>
</span><span id="Delaunay.function-906"><a href="#Delaunay.function-906"><span class="linenos">906</span></a><span class="sd">        filter out nodes that are not desired in the triangulation. Eg if you</span>
</span><span id="Delaunay.function-907"><a href="#Delaunay.function-907"><span class="linenos">907</span></a><span class="sd">        wanted to construct a delaunay triangulation of the CA atoms of an</span>
</span><span id="Delaunay.function-908"><a href="#Delaunay.function-908"><span class="linenos">908</span></a><span class="sd">        atomic graph.</span>
</span><span id="Delaunay.function-909"><a href="#Delaunay.function-909"><span class="linenos">909</span></a><span class="sd">    :type allowable_nodes: List[str], optional</span>
</span><span id="Delaunay.function-910"><a href="#Delaunay.function-910"><span class="linenos">910</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Delaunay.function-911"><a href="#Delaunay.function-911"><span class="linenos">911</span></a>    <span class="k">if</span> <span class="n">allowable_nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Delaunay.function-912"><a href="#Delaunay.function-912"><span class="linenos">912</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
</span><span id="Delaunay.function-913"><a href="#Delaunay.function-913"><span class="linenos">913</span></a>        <span class="n">node_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()))</span>
</span><span id="Delaunay.function-914"><a href="#Delaunay.function-914"><span class="linenos">914</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Delaunay.function-915"><a href="#Delaunay.function-915"><span class="linenos">915</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Delaunay.function-916"><a href="#Delaunay.function-916"><span class="linenos">916</span></a>            <span class="p">[</span>
</span><span id="Delaunay.function-917"><a href="#Delaunay.function-917"><span class="linenos">917</span></a>                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span>
</span><span id="Delaunay.function-918"><a href="#Delaunay.function-918"><span class="linenos">918</span></a>                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Delaunay.function-919"><a href="#Delaunay.function-919"><span class="linenos">919</span></a>                <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;atom_type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowable_nodes</span>
</span><span id="Delaunay.function-920"><a href="#Delaunay.function-920"><span class="linenos">920</span></a>            <span class="p">]</span>
</span><span id="Delaunay.function-921"><a href="#Delaunay.function-921"><span class="linenos">921</span></a>        <span class="p">)</span>
</span><span id="Delaunay.function-922"><a href="#Delaunay.function-922"><span class="linenos">922</span></a>        <span class="n">node_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Delaunay.function-923"><a href="#Delaunay.function-923"><span class="linenos">923</span></a>            <span class="n">i</span><span class="p">:</span> <span class="n">n</span>
</span><span id="Delaunay.function-924"><a href="#Delaunay.function-924"><span class="linenos">924</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Delaunay.function-925"><a href="#Delaunay.function-925"><span class="linenos">925</span></a>            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;atom_type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowable_nodes</span>
</span><span id="Delaunay.function-926"><a href="#Delaunay.function-926"><span class="linenos">926</span></a>        <span class="p">}</span>
</span><span id="Delaunay.function-927"><a href="#Delaunay.function-927"><span class="linenos">927</span></a>        <span class="n">node_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">node_map</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="Delaunay.function-928"><a href="#Delaunay.function-928"><span class="linenos">928</span></a>
</span><span id="Delaunay.function-929"><a href="#Delaunay.function-929"><span class="linenos">929</span></a>    <span class="n">tri</span> <span class="o">=</span> <span class="n">Delaunay</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>  <span class="c1"># this is the triangulation</span>
</span><span id="Delaunay.function-930"><a href="#Delaunay.function-930"><span class="linenos">930</span></a>    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="Delaunay.function-931"><a href="#Delaunay.function-931"><span class="linenos">931</span></a>        <span class="sa">f</span><span class="s2">&quot;Detected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">simplices</span><span class="p">)</span><span class="si">}</span><span class="s2"> simplices in the Delaunay Triangulation.&quot;</span>
</span><span id="Delaunay.function-932"><a href="#Delaunay.function-932"><span class="linenos">932</span></a>    <span class="p">)</span>
</span><span id="Delaunay.function-933"><a href="#Delaunay.function-933"><span class="linenos">933</span></a>    <span class="k">for</span> <span class="n">simplex</span> <span class="ow">in</span> <span class="n">tri</span><span class="o">.</span><span class="n">simplices</span><span class="p">:</span>
</span><span id="Delaunay.function-934"><a href="#Delaunay.function-934"><span class="linenos">934</span></a>        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node_map</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">simplex</span><span class="p">]</span>
</span><span id="Delaunay.function-935"><a href="#Delaunay.function-935"><span class="linenos">935</span></a>        <span class="k">for</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="Delaunay.function-936"><a href="#Delaunay.function-936"><span class="linenos">936</span></a>            <span class="k">if</span> <span class="n">n1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span> <span class="ow">or</span> <span class="n">n2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="Delaunay.function-937"><a href="#Delaunay.function-937"><span class="linenos">937</span></a>                <span class="k">continue</span>
</span><span id="Delaunay.function-938"><a href="#Delaunay.function-938"><span class="linenos">938</span></a>            <span class="n">add_edge</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="s2">&quot;delaunay&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the Delaunay triangulation of the protein structure.</p>

<p>This has been used in prior work. References:</p>

<pre><code>Harrison, R. W., Yu, X. &amp; Weber, I. T. Using triangulation to include
target structure improves drug resistance prediction accuracy. in 11
(IEEE, 2013). doi:10.1109/ICCABS.2013.6629236

Yu, X., Weber, I. T. &amp; Harrison, R. W. Prediction of HIV drug
resistance from genotype with encoded three-dimensional protein
structure. BMC Genomics 15 Suppl 5, S1 (2014).
</code></pre>

<p>Notes:</p>

<ol>
<li>We do not use the add_interacting_resis function, because this
interaction is computed on the <code>CA</code> atoms. Therefore, there is code
duplication. For now, I have chosen to leave this code duplication
in.</li>
</ol>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>G</strong>:  The networkx graph to add the triangulation to.</li>
<li><strong>allowable_nodes</strong>:  The nodes to include in the triangulation.
If <code>None</code> (default), no filtering is done. This parameter is used to
filter out nodes that are not desired in the triangulation. Eg if you
wanted to construct a delaunay triangulation of the CA atoms of an
atomic graph.</li>
</ul>
</div>


                            </div>
                            <div id="Delaunay.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;delaunay&#39;</span>

        
    </div>
    <a class="headerlink" href="#Delaunay.id"></a>
    
    

                            </div>
                            <div id="Delaunay.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#Delaunay.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="Delaunay.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="Delaunay.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="Delaunay.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="Delaunay.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Disulfide">
                            <input id="Disulfide-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Disulfide</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="Disulfide-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide-40"><a href="#Disulfide-40"><span class="linenos">40</span></a><span class="k">class</span> <span class="nc">Disulfide</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="Disulfide-41"><a href="#Disulfide-41"><span class="linenos">41</span></a>
</span><span id="Disulfide-42"><a href="#Disulfide-42"><span class="linenos">42</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_disulfide_interactions</span>
</span><span id="Disulfide-43"><a href="#Disulfide-43"><span class="linenos">43</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;disulfide&quot;</span>
</span></pre></div>


    

                            <div id="Disulfide.function" class="classattr">
                                        <input id="Disulfide.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.function-292"><a href="#Disulfide.function-292"><span class="linenos">292</span></a><span class="k">def</span> <span class="nf">add_disulfide_interactions</span><span class="p">(</span>
</span><span id="Disulfide.function-293"><a href="#Disulfide.function-293"><span class="linenos">293</span></a>    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Disulfide.function-294"><a href="#Disulfide.function-294"><span class="linenos">294</span></a><span class="p">):</span>
</span><span id="Disulfide.function-295"><a href="#Disulfide.function-295"><span class="linenos">295</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.function-296"><a href="#Disulfide.function-296"><span class="linenos">296</span></a><span class="sd">    Find all disulfide interactions between CYS residues</span>
</span><span id="Disulfide.function-297"><a href="#Disulfide.function-297"><span class="linenos">297</span></a><span class="sd">    (:const:`~graphein.protein.resi_atoms.DISULFIDE_RESIS`,</span>
</span><span id="Disulfide.function-298"><a href="#Disulfide.function-298"><span class="linenos">298</span></a><span class="sd">    :const:`~graphein.protein.resi_atoms.DISULFIDE_ATOMS`).</span>
</span><span id="Disulfide.function-299"><a href="#Disulfide.function-299"><span class="linenos">299</span></a>
</span><span id="Disulfide.function-300"><a href="#Disulfide.function-300"><span class="linenos">300</span></a><span class="sd">    Criteria: sulfur atom pairs are within 2.2A of each other.</span>
</span><span id="Disulfide.function-301"><a href="#Disulfide.function-301"><span class="linenos">301</span></a>
</span><span id="Disulfide.function-302"><a href="#Disulfide.function-302"><span class="linenos">302</span></a><span class="sd">    :param G: networkx protein graph</span>
</span><span id="Disulfide.function-303"><a href="#Disulfide.function-303"><span class="linenos">303</span></a><span class="sd">    :type G: nx.Graph</span>
</span><span id="Disulfide.function-304"><a href="#Disulfide.function-304"><span class="linenos">304</span></a><span class="sd">    :param rgroup_df: pd.DataFrame containing rgroup data, defaults to ``None``,</span>
</span><span id="Disulfide.function-305"><a href="#Disulfide.function-305"><span class="linenos">305</span></a><span class="sd">        which retrieves the df from the provided nx graph.</span>
</span><span id="Disulfide.function-306"><a href="#Disulfide.function-306"><span class="linenos">306</span></a><span class="sd">    :type rgroup_df: pd.DataFrame, optional</span>
</span><span id="Disulfide.function-307"><a href="#Disulfide.function-307"><span class="linenos">307</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Disulfide.function-308"><a href="#Disulfide.function-308"><span class="linenos">308</span></a>    <span class="c1"># Check for existence of at least two Cysteine residues</span>
</span><span id="Disulfide.function-309"><a href="#Disulfide.function-309"><span class="linenos">309</span></a>    <span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
</span><span id="Disulfide.function-310"><a href="#Disulfide.function-310"><span class="linenos">310</span></a>    <span class="k">if</span> <span class="n">residues</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;CYS&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Disulfide.function-311"><a href="#Disulfide.function-311"><span class="linenos">311</span></a>        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="Disulfide.function-312"><a href="#Disulfide.function-312"><span class="linenos">312</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">residues</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;CYS&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> CYS residues found. Cannot add disulfide </span><span class="se">\</span>
</span><span id="Disulfide.function-313"><a href="#Disulfide.function-313"><span class="linenos">313</span></a><span class="s2">                interactions with fewer than two CYS residues.&quot;</span>
</span><span id="Disulfide.function-314"><a href="#Disulfide.function-314"><span class="linenos">314</span></a>        <span class="p">)</span>
</span><span id="Disulfide.function-315"><a href="#Disulfide.function-315"><span class="linenos">315</span></a>        <span class="k">return</span>
</span><span id="Disulfide.function-316"><a href="#Disulfide.function-316"><span class="linenos">316</span></a>
</span><span id="Disulfide.function-317"><a href="#Disulfide.function-317"><span class="linenos">317</span></a>    <span class="k">if</span> <span class="n">rgroup_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide.function-318"><a href="#Disulfide.function-318"><span class="linenos">318</span></a>        <span class="n">rgroup_df</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;rgroup_df&quot;</span><span class="p">]</span>
</span><span id="Disulfide.function-319"><a href="#Disulfide.function-319"><span class="linenos">319</span></a>    <span class="n">disulfide_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="Disulfide.function-320"><a href="#Disulfide.function-320"><span class="linenos">320</span></a>        <span class="n">rgroup_df</span><span class="p">,</span> <span class="s2">&quot;residue_name&quot;</span><span class="p">,</span> <span class="n">DISULFIDE_RESIS</span><span class="p">,</span> <span class="kc">True</span>
</span><span id="Disulfide.function-321"><a href="#Disulfide.function-321"><span class="linenos">321</span></a>    <span class="p">)</span>
</span><span id="Disulfide.function-322"><a href="#Disulfide.function-322"><span class="linenos">322</span></a>    <span class="n">disulfide_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="Disulfide.function-323"><a href="#Disulfide.function-323"><span class="linenos">323</span></a>        <span class="n">disulfide_df</span><span class="p">,</span> <span class="s2">&quot;atom_name&quot;</span><span class="p">,</span> <span class="n">DISULFIDE_ATOMS</span><span class="p">,</span> <span class="kc">True</span>
</span><span id="Disulfide.function-324"><a href="#Disulfide.function-324"><span class="linenos">324</span></a>    <span class="p">)</span>
</span><span id="Disulfide.function-325"><a href="#Disulfide.function-325"><span class="linenos">325</span></a>    <span class="c1"># Ensure only residues in the graph are kept</span>
</span><span id="Disulfide.function-326"><a href="#Disulfide.function-326"><span class="linenos">326</span></a>    <span class="n">disulfide_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="Disulfide.function-327"><a href="#Disulfide.function-327"><span class="linenos">327</span></a>        <span class="n">disulfide_df</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">),</span> <span class="kc">True</span>
</span><span id="Disulfide.function-328"><a href="#Disulfide.function-328"><span class="linenos">328</span></a>    <span class="p">)</span>
</span><span id="Disulfide.function-329"><a href="#Disulfide.function-329"><span class="linenos">329</span></a>    <span class="k">if</span> <span class="n">disulfide_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Disulfide.function-330"><a href="#Disulfide.function-330"><span class="linenos">330</span></a>        <span class="n">distmat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">disulfide_df</span><span class="p">)</span>
</span><span id="Disulfide.function-331"><a href="#Disulfide.function-331"><span class="linenos">331</span></a>        <span class="n">interacting_atoms</span> <span class="o">=</span> <span class="n">get_interacting_atoms</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">distmat</span><span class="p">)</span>
</span><span id="Disulfide.function-332"><a href="#Disulfide.function-332"><span class="linenos">332</span></a>        <span class="n">add_interacting_resis</span><span class="p">(</span>
</span><span id="Disulfide.function-333"><a href="#Disulfide.function-333"><span class="linenos">333</span></a>            <span class="n">G</span><span class="p">,</span> <span class="n">interacting_atoms</span><span class="p">,</span> <span class="n">disulfide_df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;disulfide&quot;</span><span class="p">]</span>
</span><span id="Disulfide.function-334"><a href="#Disulfide.function-334"><span class="linenos">334</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Find all disulfide interactions between CYS residues
(<code>~graphein.protein.resi_atoms.DISULFIDE_RESIS</code>,
<code>~graphein.protein.resi_atoms.DISULFIDE_ATOMS</code>).</p>

<p>Criteria: sulfur atom pairs are within 2.2A of each other.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>G</strong>:  networkx protein graph</li>
<li><strong>rgroup_df</strong>:  pd.DataFrame containing rgroup data, defaults to <code>None</code>,
which retrieves the df from the provided nx graph.</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;disulfide&#39;</span>

        
    </div>
    <a class="headerlink" href="#Disulfide.id"></a>
    
    

                            </div>
                            <div id="Disulfide.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#Disulfide.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="Disulfide.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="Disulfide.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="Disulfide.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="Disulfide.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="HydrogenBond">
                            <input id="HydrogenBond-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">HydrogenBond</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="HydrogenBond-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HydrogenBond"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HydrogenBond-46"><a href="#HydrogenBond-46"><span class="linenos">46</span></a><span class="k">class</span> <span class="nc">HydrogenBond</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="HydrogenBond-47"><a href="#HydrogenBond-47"><span class="linenos">47</span></a>
</span><span id="HydrogenBond-48"><a href="#HydrogenBond-48"><span class="linenos">48</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_hydrogen_bond_interactions</span>
</span><span id="HydrogenBond-49"><a href="#HydrogenBond-49"><span class="linenos">49</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hbond&quot;</span>
</span></pre></div>


    

                            <div id="HydrogenBond.function" class="classattr">
                                        <input id="HydrogenBond.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HydrogenBond.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HydrogenBond.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HydrogenBond.function-337"><a href="#HydrogenBond.function-337"><span class="linenos">337</span></a><span class="k">def</span> <span class="nf">add_hydrogen_bond_interactions</span><span class="p">(</span>
</span><span id="HydrogenBond.function-338"><a href="#HydrogenBond.function-338"><span class="linenos">338</span></a>    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="HydrogenBond.function-339"><a href="#HydrogenBond.function-339"><span class="linenos">339</span></a><span class="p">):</span>
</span><span id="HydrogenBond.function-340"><a href="#HydrogenBond.function-340"><span class="linenos">340</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add all hydrogen-bond interactions.&quot;&quot;&quot;</span>
</span><span id="HydrogenBond.function-341"><a href="#HydrogenBond.function-341"><span class="linenos">341</span></a>    <span class="c1"># For these atoms, find those that are within 3.5A of one another.</span>
</span><span id="HydrogenBond.function-342"><a href="#HydrogenBond.function-342"><span class="linenos">342</span></a>    <span class="k">if</span> <span class="n">rgroup_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HydrogenBond.function-343"><a href="#HydrogenBond.function-343"><span class="linenos">343</span></a>        <span class="n">rgroup_df</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;rgroup_df&quot;</span><span class="p">]</span>
</span><span id="HydrogenBond.function-344"><a href="#HydrogenBond.function-344"><span class="linenos">344</span></a>    <span class="n">rgroup_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span><span class="n">rgroup_df</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()),</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="HydrogenBond.function-345"><a href="#HydrogenBond.function-345"><span class="linenos">345</span></a>    <span class="n">HBOND_ATOMS</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="HydrogenBond.function-346"><a href="#HydrogenBond.function-346"><span class="linenos">346</span></a>        <span class="s2">&quot;ND&quot;</span><span class="p">,</span>  <span class="c1"># histidine and asparagine</span>
</span><span id="HydrogenBond.function-347"><a href="#HydrogenBond.function-347"><span class="linenos">347</span></a>        <span class="s2">&quot;NE&quot;</span><span class="p">,</span>  <span class="c1"># glutamate, tryptophan, arginine, histidine</span>
</span><span id="HydrogenBond.function-348"><a href="#HydrogenBond.function-348"><span class="linenos">348</span></a>        <span class="s2">&quot;NH&quot;</span><span class="p">,</span>  <span class="c1"># arginine</span>
</span><span id="HydrogenBond.function-349"><a href="#HydrogenBond.function-349"><span class="linenos">349</span></a>        <span class="s2">&quot;NZ&quot;</span><span class="p">,</span>  <span class="c1"># lysine</span>
</span><span id="HydrogenBond.function-350"><a href="#HydrogenBond.function-350"><span class="linenos">350</span></a>        <span class="s2">&quot;OD1&quot;</span><span class="p">,</span>
</span><span id="HydrogenBond.function-351"><a href="#HydrogenBond.function-351"><span class="linenos">351</span></a>        <span class="s2">&quot;OD2&quot;</span><span class="p">,</span>
</span><span id="HydrogenBond.function-352"><a href="#HydrogenBond.function-352"><span class="linenos">352</span></a>        <span class="s2">&quot;OE&quot;</span><span class="p">,</span>
</span><span id="HydrogenBond.function-353"><a href="#HydrogenBond.function-353"><span class="linenos">353</span></a>        <span class="s2">&quot;OG&quot;</span><span class="p">,</span>
</span><span id="HydrogenBond.function-354"><a href="#HydrogenBond.function-354"><span class="linenos">354</span></a>        <span class="s2">&quot;OH&quot;</span><span class="p">,</span>
</span><span id="HydrogenBond.function-355"><a href="#HydrogenBond.function-355"><span class="linenos">355</span></a>        <span class="s2">&quot;SD&quot;</span><span class="p">,</span>  <span class="c1"># cysteine</span>
</span><span id="HydrogenBond.function-356"><a href="#HydrogenBond.function-356"><span class="linenos">356</span></a>        <span class="s2">&quot;SG&quot;</span><span class="p">,</span>  <span class="c1"># methionine</span>
</span><span id="HydrogenBond.function-357"><a href="#HydrogenBond.function-357"><span class="linenos">357</span></a>        <span class="s2">&quot;N&quot;</span><span class="p">,</span>
</span><span id="HydrogenBond.function-358"><a href="#HydrogenBond.function-358"><span class="linenos">358</span></a>        <span class="s2">&quot;O&quot;</span><span class="p">,</span>
</span><span id="HydrogenBond.function-359"><a href="#HydrogenBond.function-359"><span class="linenos">359</span></a>    <span class="p">]</span>
</span><span id="HydrogenBond.function-360"><a href="#HydrogenBond.function-360"><span class="linenos">360</span></a>    <span class="n">hbond_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span><span class="n">rgroup_df</span><span class="p">,</span> <span class="s2">&quot;atom_name&quot;</span><span class="p">,</span> <span class="n">HBOND_ATOMS</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="HydrogenBond.function-361"><a href="#HydrogenBond.function-361"><span class="linenos">361</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hbond_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="HydrogenBond.function-362"><a href="#HydrogenBond.function-362"><span class="linenos">362</span></a>        <span class="n">distmat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">hbond_df</span><span class="p">)</span>
</span><span id="HydrogenBond.function-363"><a href="#HydrogenBond.function-363"><span class="linenos">363</span></a>        <span class="n">interacting_atoms</span> <span class="o">=</span> <span class="n">get_interacting_atoms</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">distmat</span><span class="p">)</span>
</span><span id="HydrogenBond.function-364"><a href="#HydrogenBond.function-364"><span class="linenos">364</span></a>        <span class="n">add_interacting_resis</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">interacting_atoms</span><span class="p">,</span> <span class="n">hbond_df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;hbond&quot;</span><span class="p">])</span>
</span><span id="HydrogenBond.function-365"><a href="#HydrogenBond.function-365"><span class="linenos">365</span></a>
</span><span id="HydrogenBond.function-366"><a href="#HydrogenBond.function-366"><span class="linenos">366</span></a>    <span class="c1"># For these atoms, find those that are within 4.0A of one another.</span>
</span><span id="HydrogenBond.function-367"><a href="#HydrogenBond.function-367"><span class="linenos">367</span></a>    <span class="n">HBOND_ATOMS_SULPHUR</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SD&quot;</span><span class="p">,</span> <span class="s2">&quot;SG&quot;</span><span class="p">]</span>
</span><span id="HydrogenBond.function-368"><a href="#HydrogenBond.function-368"><span class="linenos">368</span></a>    <span class="n">hbond_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="HydrogenBond.function-369"><a href="#HydrogenBond.function-369"><span class="linenos">369</span></a>        <span class="n">rgroup_df</span><span class="p">,</span> <span class="s2">&quot;atom_name&quot;</span><span class="p">,</span> <span class="n">HBOND_ATOMS_SULPHUR</span><span class="p">,</span> <span class="kc">True</span>
</span><span id="HydrogenBond.function-370"><a href="#HydrogenBond.function-370"><span class="linenos">370</span></a>    <span class="p">)</span>
</span><span id="HydrogenBond.function-371"><a href="#HydrogenBond.function-371"><span class="linenos">371</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hbond_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="HydrogenBond.function-372"><a href="#HydrogenBond.function-372"><span class="linenos">372</span></a>        <span class="n">distmat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">hbond_df</span><span class="p">)</span>
</span><span id="HydrogenBond.function-373"><a href="#HydrogenBond.function-373"><span class="linenos">373</span></a>        <span class="n">interacting_atoms</span> <span class="o">=</span> <span class="n">get_interacting_atoms</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">distmat</span><span class="p">)</span>
</span><span id="HydrogenBond.function-374"><a href="#HydrogenBond.function-374"><span class="linenos">374</span></a>        <span class="n">add_interacting_resis</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">interacting_atoms</span><span class="p">,</span> <span class="n">hbond_df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;hbond&quot;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Add all hydrogen-bond interactions.</p>
</div>


                            </div>
                            <div id="HydrogenBond.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;hbond&#39;</span>

        
    </div>
    <a class="headerlink" href="#HydrogenBond.id"></a>
    
    

                            </div>
                            <div id="HydrogenBond.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#HydrogenBond.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="HydrogenBond.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="HydrogenBond.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="HydrogenBond.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="HydrogenBond.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Ionic">
                            <input id="Ionic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Ionic</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="Ionic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ionic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ionic-52"><a href="#Ionic-52"><span class="linenos">52</span></a><span class="k">class</span> <span class="nc">Ionic</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="Ionic-53"><a href="#Ionic-53"><span class="linenos">53</span></a>
</span><span id="Ionic-54"><a href="#Ionic-54"><span class="linenos">54</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_ionic_interactions</span>
</span><span id="Ionic-55"><a href="#Ionic-55"><span class="linenos">55</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span>
</span></pre></div>


    

                            <div id="Ionic.function" class="classattr">
                                        <input id="Ionic.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ionic.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ionic.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ionic.function-377"><a href="#Ionic.function-377"><span class="linenos">377</span></a><span class="k">def</span> <span class="nf">add_ionic_interactions</span><span class="p">(</span>
</span><span id="Ionic.function-378"><a href="#Ionic.function-378"><span class="linenos">378</span></a>    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">rgroup_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Ionic.function-379"><a href="#Ionic.function-379"><span class="linenos">379</span></a><span class="p">):</span>
</span><span id="Ionic.function-380"><a href="#Ionic.function-380"><span class="linenos">380</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Ionic.function-381"><a href="#Ionic.function-381"><span class="linenos">381</span></a><span class="sd">    Find all ionic interactions.</span>
</span><span id="Ionic.function-382"><a href="#Ionic.function-382"><span class="linenos">382</span></a>
</span><span id="Ionic.function-383"><a href="#Ionic.function-383"><span class="linenos">383</span></a><span class="sd">    Criteria: ``[ARG, LYS, HIS, ASP, and GLU]``</span>
</span><span id="Ionic.function-384"><a href="#Ionic.function-384"><span class="linenos">384</span></a><span class="sd">    (:const:`~graphein.protein.resi_atoms.IONIC_RESIS`) residues are within 6A.</span>
</span><span id="Ionic.function-385"><a href="#Ionic.function-385"><span class="linenos">385</span></a>
</span><span id="Ionic.function-386"><a href="#Ionic.function-386"><span class="linenos">386</span></a><span class="sd">    We also check for opposing charges</span>
</span><span id="Ionic.function-387"><a href="#Ionic.function-387"><span class="linenos">387</span></a><span class="sd">    (:const:`~graphein.protein.resi_atoms.POS_AA`,</span>
</span><span id="Ionic.function-388"><a href="#Ionic.function-388"><span class="linenos">388</span></a><span class="sd">    :const:`~graphein.protein.resi_atoms.NEG_AA`).</span>
</span><span id="Ionic.function-389"><a href="#Ionic.function-389"><span class="linenos">389</span></a>
</span><span id="Ionic.function-390"><a href="#Ionic.function-390"><span class="linenos">390</span></a><span class="sd">    :param G: nx.Graph to add ionic interactions to.</span>
</span><span id="Ionic.function-391"><a href="#Ionic.function-391"><span class="linenos">391</span></a><span class="sd">    :type G: nx.Graph</span>
</span><span id="Ionic.function-392"><a href="#Ionic.function-392"><span class="linenos">392</span></a><span class="sd">    :param rgroup_df: Optional dataframe of R-group atoms. Default is ``None``.</span>
</span><span id="Ionic.function-393"><a href="#Ionic.function-393"><span class="linenos">393</span></a><span class="sd">    :type rgroup_df: Optional[pd.DataFrame]</span>
</span><span id="Ionic.function-394"><a href="#Ionic.function-394"><span class="linenos">394</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Ionic.function-395"><a href="#Ionic.function-395"><span class="linenos">395</span></a>    <span class="k">if</span> <span class="n">rgroup_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Ionic.function-396"><a href="#Ionic.function-396"><span class="linenos">396</span></a>        <span class="n">rgroup_df</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;rgroup_df&quot;</span><span class="p">]</span>
</span><span id="Ionic.function-397"><a href="#Ionic.function-397"><span class="linenos">397</span></a>    <span class="n">ionic_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span><span class="n">rgroup_df</span><span class="p">,</span> <span class="s2">&quot;residue_name&quot;</span><span class="p">,</span> <span class="n">IONIC_RESIS</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Ionic.function-398"><a href="#Ionic.function-398"><span class="linenos">398</span></a>    <span class="n">ionic_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span><span class="n">rgroup_df</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()),</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Ionic.function-399"><a href="#Ionic.function-399"><span class="linenos">399</span></a>    <span class="k">if</span> <span class="n">ionic_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Ionic.function-400"><a href="#Ionic.function-400"><span class="linenos">400</span></a>        <span class="n">distmat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">ionic_df</span><span class="p">)</span>
</span><span id="Ionic.function-401"><a href="#Ionic.function-401"><span class="linenos">401</span></a>        <span class="n">interacting_atoms</span> <span class="o">=</span> <span class="n">get_interacting_atoms</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">distmat</span><span class="p">)</span>
</span><span id="Ionic.function-402"><a href="#Ionic.function-402"><span class="linenos">402</span></a>        <span class="n">add_interacting_resis</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">interacting_atoms</span><span class="p">,</span> <span class="n">ionic_df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ionic&quot;</span><span class="p">])</span>
</span><span id="Ionic.function-403"><a href="#Ionic.function-403"><span class="linenos">403</span></a>        <span class="c1"># Check that the interacting residues are of opposite charges</span>
</span><span id="Ionic.function-404"><a href="#Ionic.function-404"><span class="linenos">404</span></a>        <span class="k">for</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="ow">in</span> <span class="n">get_edges_by_bond_type</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s2">&quot;ionic&quot;</span><span class="p">):</span>
</span><span id="Ionic.function-405"><a href="#Ionic.function-405"><span class="linenos">405</span></a>            <span class="n">condition1</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Ionic.function-406"><a href="#Ionic.function-406"><span class="linenos">406</span></a>                <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">r1</span><span class="p">][</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">POS_AA</span>
</span><span id="Ionic.function-407"><a href="#Ionic.function-407"><span class="linenos">407</span></a>                <span class="ow">and</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">r2</span><span class="p">][</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">NEG_AA</span>
</span><span id="Ionic.function-408"><a href="#Ionic.function-408"><span class="linenos">408</span></a>            <span class="p">)</span>
</span><span id="Ionic.function-409"><a href="#Ionic.function-409"><span class="linenos">409</span></a>            <span class="n">condition2</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Ionic.function-410"><a href="#Ionic.function-410"><span class="linenos">410</span></a>                <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">r2</span><span class="p">][</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">POS_AA</span>
</span><span id="Ionic.function-411"><a href="#Ionic.function-411"><span class="linenos">411</span></a>                <span class="ow">and</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">r1</span><span class="p">][</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">NEG_AA</span>
</span><span id="Ionic.function-412"><a href="#Ionic.function-412"><span class="linenos">412</span></a>            <span class="p">)</span>
</span><span id="Ionic.function-413"><a href="#Ionic.function-413"><span class="linenos">413</span></a>            <span class="n">is_ionic</span> <span class="o">=</span> <span class="n">condition1</span> <span class="ow">or</span> <span class="n">condition2</span>
</span><span id="Ionic.function-414"><a href="#Ionic.function-414"><span class="linenos">414</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_ionic</span><span class="p">:</span>
</span><span id="Ionic.function-415"><a href="#Ionic.function-415"><span class="linenos">415</span></a>                <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">][</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;ionic&quot;</span><span class="p">)</span>
</span><span id="Ionic.function-416"><a href="#Ionic.function-416"><span class="linenos">416</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">][</span><span class="s2">&quot;kind&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Ionic.function-417"><a href="#Ionic.function-417"><span class="linenos">417</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Find all ionic interactions.</p>

<p>Criteria: <code>[ARG, LYS, HIS, ASP, and GLU]</code>
(<code>~graphein.protein.resi_atoms.IONIC_RESIS</code>) residues are within 6A.</p>

<p>We also check for opposing charges
(<code>~graphein.protein.resi_atoms.POS_AA</code>,
<code>~graphein.protein.resi_atoms.NEG_AA</code>).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>G</strong>:  nx.Graph to add ionic interactions to.</li>
<li><strong>rgroup_df</strong>:  Optional dataframe of R-group atoms. Default is <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Ionic.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;ionic&#39;</span>

        
    </div>
    <a class="headerlink" href="#Ionic.id"></a>
    
    

                            </div>
                            <div id="Ionic.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#Ionic.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="Ionic.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="Ionic.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="Ionic.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="Ionic.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="KNN">
                            <input id="KNN-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">KNN</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="KNN-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#KNN"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="KNN-58"><a href="#KNN-58"><span class="linenos">58</span></a><span class="k">class</span> <span class="nc">KNN</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="KNN-59"><a href="#KNN-59"><span class="linenos">59</span></a>
</span><span id="KNN-60"><a href="#KNN-60"><span class="linenos">60</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_k_nn_edges</span>
</span><span id="KNN-61"><a href="#KNN-61"><span class="linenos">61</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;knn&quot;</span>
</span><span id="KNN-62"><a href="#KNN-62"><span class="linenos">62</span></a>
</span><span id="KNN-63"><a href="#KNN-63"><span class="linenos">63</span></a>    <span class="n">long_interaction_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
</span><span id="KNN-64"><a href="#KNN-64"><span class="linenos">64</span></a>    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="KNN-65"><a href="#KNN-65"><span class="linenos">65</span></a>    <span class="n">exclude_edges</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;inter&quot;</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="KNN-66"><a href="#KNN-66"><span class="linenos">66</span></a>    <span class="n">exclude_self_loops</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


    

                            <div id="KNN.function" class="classattr">
                                        <input id="KNN.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>,</span><span class="param">	<span class="n">long_interaction_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>,</span><span class="param">	<span class="n">exclude_edges</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>,</span><span class="param">	<span class="n">exclude_self_loops</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">kind_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;knn&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="KNN.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#KNN.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="KNN.function-1059"><a href="#KNN.function-1059"><span class="linenos">1059</span></a><span class="k">def</span> <span class="nf">add_k_nn_edges</span><span class="p">(</span>
</span><span id="KNN.function-1060"><a href="#KNN.function-1060"><span class="linenos">1060</span></a>    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span>
</span><span id="KNN.function-1061"><a href="#KNN.function-1061"><span class="linenos">1061</span></a>    <span class="n">long_interaction_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="KNN.function-1062"><a href="#KNN.function-1062"><span class="linenos">1062</span></a>    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
</span><span id="KNN.function-1063"><a href="#KNN.function-1063"><span class="linenos">1063</span></a>    <span class="n">exclude_edges</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
</span><span id="KNN.function-1064"><a href="#KNN.function-1064"><span class="linenos">1064</span></a>    <span class="n">exclude_self_loops</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="KNN.function-1065"><a href="#KNN.function-1065"><span class="linenos">1065</span></a>    <span class="n">kind_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;knn&quot;</span><span class="p">,</span>
</span><span id="KNN.function-1066"><a href="#KNN.function-1066"><span class="linenos">1066</span></a><span class="p">):</span>
</span><span id="KNN.function-1067"><a href="#KNN.function-1067"><span class="linenos">1067</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="KNN.function-1068"><a href="#KNN.function-1068"><span class="linenos">1068</span></a><span class="sd">    Adds edges to nodes based on K nearest neighbours. Long interaction</span>
</span><span id="KNN.function-1069"><a href="#KNN.function-1069"><span class="linenos">1069</span></a><span class="sd">    threshold is used to specify minimum separation in sequence to add an edge</span>
</span><span id="KNN.function-1070"><a href="#KNN.function-1070"><span class="linenos">1070</span></a><span class="sd">    between networkx nodes within the distance threshold</span>
</span><span id="KNN.function-1071"><a href="#KNN.function-1071"><span class="linenos">1071</span></a>
</span><span id="KNN.function-1072"><a href="#KNN.function-1072"><span class="linenos">1072</span></a><span class="sd">    :param G: Protein Structure graph to add distance edges to</span>
</span><span id="KNN.function-1073"><a href="#KNN.function-1073"><span class="linenos">1073</span></a><span class="sd">    :type G: nx.Graph</span>
</span><span id="KNN.function-1074"><a href="#KNN.function-1074"><span class="linenos">1074</span></a><span class="sd">    :param long_interaction_threshold: minimum distance in sequence for two</span>
</span><span id="KNN.function-1075"><a href="#KNN.function-1075"><span class="linenos">1075</span></a><span class="sd">        nodes to be connected</span>
</span><span id="KNN.function-1076"><a href="#KNN.function-1076"><span class="linenos">1076</span></a><span class="sd">    :type long_interaction_threshold: int</span>
</span><span id="KNN.function-1077"><a href="#KNN.function-1077"><span class="linenos">1077</span></a><span class="sd">    :param k: Number of neighbors for each sample.</span>
</span><span id="KNN.function-1078"><a href="#KNN.function-1078"><span class="linenos">1078</span></a><span class="sd">    :type k: int</span>
</span><span id="KNN.function-1079"><a href="#KNN.function-1079"><span class="linenos">1079</span></a><span class="sd">    :param exclude_edges: Types of edges to exclude. Supported values are</span>
</span><span id="KNN.function-1080"><a href="#KNN.function-1080"><span class="linenos">1080</span></a><span class="sd">        `inter` and `intra`.</span>
</span><span id="KNN.function-1081"><a href="#KNN.function-1081"><span class="linenos">1081</span></a><span class="sd">        - `inter` removes inter-connections between nodes of the same chain.</span>
</span><span id="KNN.function-1082"><a href="#KNN.function-1082"><span class="linenos">1082</span></a><span class="sd">        - `intra` removes intra-connections between nodes of different chains.</span>
</span><span id="KNN.function-1083"><a href="#KNN.function-1083"><span class="linenos">1083</span></a><span class="sd">    :type exclude_edges: Iterable[str].</span>
</span><span id="KNN.function-1084"><a href="#KNN.function-1084"><span class="linenos">1084</span></a><span class="sd">    :param exclude_self_loops: Whether or not to mark each sample as the first</span>
</span><span id="KNN.function-1085"><a href="#KNN.function-1085"><span class="linenos">1085</span></a><span class="sd">        nearest neighbor to itself.</span>
</span><span id="KNN.function-1086"><a href="#KNN.function-1086"><span class="linenos">1086</span></a><span class="sd">    :type exclude_self_loops: Union[bool, str]</span>
</span><span id="KNN.function-1087"><a href="#KNN.function-1087"><span class="linenos">1087</span></a><span class="sd">    :param kind_name: Name for kind of edges in networkx graph.</span>
</span><span id="KNN.function-1088"><a href="#KNN.function-1088"><span class="linenos">1088</span></a><span class="sd">    :type kind_name: str</span>
</span><span id="KNN.function-1089"><a href="#KNN.function-1089"><span class="linenos">1089</span></a><span class="sd">    :return: Graph with knn-based edges added</span>
</span><span id="KNN.function-1090"><a href="#KNN.function-1090"><span class="linenos">1090</span></a><span class="sd">    :rtype: nx.Graph</span>
</span><span id="KNN.function-1091"><a href="#KNN.function-1091"><span class="linenos">1091</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="KNN.function-1092"><a href="#KNN.function-1092"><span class="linenos">1092</span></a>    <span class="c1"># Prepare dataframe</span>
</span><span id="KNN.function-1093"><a href="#KNN.function-1093"><span class="linenos">1093</span></a>    <span class="n">pdb_df</span> <span class="o">=</span> <span class="n">filter_dataframe</span><span class="p">(</span>
</span><span id="KNN.function-1094"><a href="#KNN.function-1094"><span class="linenos">1094</span></a>        <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;pdb_df&quot;</span><span class="p">],</span> <span class="s2">&quot;node_id&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()),</span> <span class="kc">True</span>
</span><span id="KNN.function-1095"><a href="#KNN.function-1095"><span class="linenos">1095</span></a>    <span class="p">)</span>
</span><span id="KNN.function-1096"><a href="#KNN.function-1096"><span class="linenos">1096</span></a>    <span class="k">if</span> <span class="p">(</span>
</span><span id="KNN.function-1097"><a href="#KNN.function-1097"><span class="linenos">1097</span></a>        <span class="n">pdb_df</span><span class="p">[</span><span class="s2">&quot;x_coord&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="KNN.function-1098"><a href="#KNN.function-1098"><span class="linenos">1098</span></a>        <span class="ow">or</span> <span class="n">pdb_df</span><span class="p">[</span><span class="s2">&quot;y_coord&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="KNN.function-1099"><a href="#KNN.function-1099"><span class="linenos">1099</span></a>        <span class="ow">or</span> <span class="n">pdb_df</span><span class="p">[</span><span class="s2">&quot;z_coord&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="KNN.function-1100"><a href="#KNN.function-1100"><span class="linenos">1100</span></a>    <span class="p">):</span>
</span><span id="KNN.function-1101"><a href="#KNN.function-1101"><span class="linenos">1101</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Coordinates contain a NaN value.&quot;</span><span class="p">)</span>
</span><span id="KNN.function-1102"><a href="#KNN.function-1102"><span class="linenos">1102</span></a>    <span class="n">pdb_df</span> <span class="o">=</span> <span class="n">pdb_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="KNN.function-1103"><a href="#KNN.function-1103"><span class="linenos">1103</span></a>
</span><span id="KNN.function-1104"><a href="#KNN.function-1104"><span class="linenos">1104</span></a>    <span class="c1"># Construct distance matrix</span>
</span><span id="KNN.function-1105"><a href="#KNN.function-1105"><span class="linenos">1105</span></a>    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">compute_distmat</span><span class="p">(</span><span class="n">pdb_df</span><span class="p">)</span>
</span><span id="KNN.function-1106"><a href="#KNN.function-1106"><span class="linenos">1106</span></a>
</span><span id="KNN.function-1107"><a href="#KNN.function-1107"><span class="linenos">1107</span></a>    <span class="c1"># Filter edges</span>
</span><span id="KNN.function-1108"><a href="#KNN.function-1108"><span class="linenos">1108</span></a>    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">filter_distmat</span><span class="p">(</span><span class="n">pdb_df</span><span class="p">,</span> <span class="n">dist_mat</span><span class="p">,</span> <span class="n">exclude_edges</span><span class="p">)</span>
</span><span id="KNN.function-1109"><a href="#KNN.function-1109"><span class="linenos">1109</span></a>
</span><span id="KNN.function-1110"><a href="#KNN.function-1110"><span class="linenos">1110</span></a>    <span class="c1"># Add self-loops if specified</span>
</span><span id="KNN.function-1111"><a href="#KNN.function-1111"><span class="linenos">1111</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">exclude_self_loops</span><span class="p">:</span>
</span><span id="KNN.function-1112"><a href="#KNN.function-1112"><span class="linenos">1112</span></a>        <span class="n">k</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="KNN.function-1113"><a href="#KNN.function-1113"><span class="linenos">1113</span></a>        <span class="k">for</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()):</span>
</span><span id="KNN.function-1114"><a href="#KNN.function-1114"><span class="linenos">1114</span></a>            <span class="n">add_edge</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">kind_name</span><span class="p">)</span>
</span><span id="KNN.function-1115"><a href="#KNN.function-1115"><span class="linenos">1115</span></a>
</span><span id="KNN.function-1116"><a href="#KNN.function-1116"><span class="linenos">1116</span></a>    <span class="c1"># Reduce k if number of nodes is less (to avoid sklearn error)</span>
</span><span id="KNN.function-1117"><a href="#KNN.function-1117"><span class="linenos">1117</span></a>    <span class="c1"># Note: - 1 because self-loops are not included</span>
</span><span id="KNN.function-1118"><a href="#KNN.function-1118"><span class="linenos">1118</span></a>    <span class="k">if</span> <span class="n">G</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
</span><span id="KNN.function-1119"><a href="#KNN.function-1119"><span class="linenos">1119</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="KNN.function-1120"><a href="#KNN.function-1120"><span class="linenos">1120</span></a>
</span><span id="KNN.function-1121"><a href="#KNN.function-1121"><span class="linenos">1121</span></a>    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="KNN.function-1122"><a href="#KNN.function-1122"><span class="linenos">1122</span></a>        <span class="k">return</span>
</span><span id="KNN.function-1123"><a href="#KNN.function-1123"><span class="linenos">1123</span></a>
</span><span id="KNN.function-1124"><a href="#KNN.function-1124"><span class="linenos">1124</span></a>    <span class="c1"># Run k-NN search</span>
</span><span id="KNN.function-1125"><a href="#KNN.function-1125"><span class="linenos">1125</span></a>    <span class="n">neigh</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;precomputed&quot;</span><span class="p">)</span>
</span><span id="KNN.function-1126"><a href="#KNN.function-1126"><span class="linenos">1126</span></a>    <span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">)</span>
</span><span id="KNN.function-1127"><a href="#KNN.function-1127"><span class="linenos">1127</span></a>    <span class="n">nn</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">kneighbors_graph</span><span class="p">()</span>
</span><span id="KNN.function-1128"><a href="#KNN.function-1128"><span class="linenos">1128</span></a>
</span><span id="KNN.function-1129"><a href="#KNN.function-1129"><span class="linenos">1129</span></a>    <span class="c1"># Create iterable of node indices</span>
</span><span id="KNN.function-1130"><a href="#KNN.function-1130"><span class="linenos">1130</span></a>    <span class="n">outgoing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pdb_df</span><span class="p">))),</span> <span class="n">k</span><span class="p">)</span>
</span><span id="KNN.function-1131"><a href="#KNN.function-1131"><span class="linenos">1131</span></a>    <span class="n">incoming</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">indices</span>
</span><span id="KNN.function-1132"><a href="#KNN.function-1132"><span class="linenos">1132</span></a>    <span class="n">interacting_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">outgoing</span><span class="p">,</span> <span class="n">incoming</span><span class="p">))</span>
</span><span id="KNN.function-1133"><a href="#KNN.function-1133"><span class="linenos">1133</span></a>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">interacting_nodes</span><span class="p">)</span><span class="si">}</span><span class="s2"> KNN edges&quot;</span><span class="p">)</span>
</span><span id="KNN.function-1134"><a href="#KNN.function-1134"><span class="linenos">1134</span></a>    <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="n">interacting_nodes</span><span class="p">:</span>
</span><span id="KNN.function-1135"><a href="#KNN.function-1135"><span class="linenos">1135</span></a>        <span class="k">if</span> <span class="n">dist_mat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">]</span> <span class="o">==</span> <span class="n">INFINITE_DIST</span><span class="p">:</span>
</span><span id="KNN.function-1136"><a href="#KNN.function-1136"><span class="linenos">1136</span></a>            <span class="k">continue</span>
</span><span id="KNN.function-1137"><a href="#KNN.function-1137"><span class="linenos">1137</span></a>
</span><span id="KNN.function-1138"><a href="#KNN.function-1138"><span class="linenos">1138</span></a>        <span class="c1"># Get nodes IDs from indices</span>
</span><span id="KNN.function-1139"><a href="#KNN.function-1139"><span class="linenos">1139</span></a>        <span class="n">n1</span> <span class="o">=</span> <span class="n">pdb_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">]</span>
</span><span id="KNN.function-1140"><a href="#KNN.function-1140"><span class="linenos">1140</span></a>        <span class="n">n2</span> <span class="o">=</span> <span class="n">pdb_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a2</span><span class="p">,</span> <span class="s2">&quot;node_id&quot;</span><span class="p">]</span>
</span><span id="KNN.function-1141"><a href="#KNN.function-1141"><span class="linenos">1141</span></a>
</span><span id="KNN.function-1142"><a href="#KNN.function-1142"><span class="linenos">1142</span></a>        <span class="c1"># Get chains</span>
</span><span id="KNN.function-1143"><a href="#KNN.function-1143"><span class="linenos">1143</span></a>        <span class="n">n1_chain</span> <span class="o">=</span> <span class="n">pdb_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="KNN.function-1144"><a href="#KNN.function-1144"><span class="linenos">1144</span></a>        <span class="n">n2_chain</span> <span class="o">=</span> <span class="n">pdb_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a2</span><span class="p">,</span> <span class="s2">&quot;chain_id&quot;</span><span class="p">]</span>
</span><span id="KNN.function-1145"><a href="#KNN.function-1145"><span class="linenos">1145</span></a>
</span><span id="KNN.function-1146"><a href="#KNN.function-1146"><span class="linenos">1146</span></a>        <span class="c1"># Get sequence position</span>
</span><span id="KNN.function-1147"><a href="#KNN.function-1147"><span class="linenos">1147</span></a>        <span class="n">n1_position</span> <span class="o">=</span> <span class="n">pdb_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="s2">&quot;residue_number&quot;</span><span class="p">]</span>
</span><span id="KNN.function-1148"><a href="#KNN.function-1148"><span class="linenos">1148</span></a>        <span class="n">n2_position</span> <span class="o">=</span> <span class="n">pdb_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a2</span><span class="p">,</span> <span class="s2">&quot;residue_number&quot;</span><span class="p">]</span>
</span><span id="KNN.function-1149"><a href="#KNN.function-1149"><span class="linenos">1149</span></a>
</span><span id="KNN.function-1150"><a href="#KNN.function-1150"><span class="linenos">1150</span></a>        <span class="c1"># Check residues are not on same chain</span>
</span><span id="KNN.function-1151"><a href="#KNN.function-1151"><span class="linenos">1151</span></a>        <span class="n">condition_1</span> <span class="o">=</span> <span class="n">n1_chain</span> <span class="o">!=</span> <span class="n">n2_chain</span>
</span><span id="KNN.function-1152"><a href="#KNN.function-1152"><span class="linenos">1152</span></a>        <span class="c1"># Check residues are separated by long_interaction_threshold</span>
</span><span id="KNN.function-1153"><a href="#KNN.function-1153"><span class="linenos">1153</span></a>        <span class="n">condition_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="KNN.function-1154"><a href="#KNN.function-1154"><span class="linenos">1154</span></a>            <span class="nb">abs</span><span class="p">(</span><span class="n">n1_position</span> <span class="o">-</span> <span class="n">n2_position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">long_interaction_threshold</span>
</span><span id="KNN.function-1155"><a href="#KNN.function-1155"><span class="linenos">1155</span></a>        <span class="p">)</span>
</span><span id="KNN.function-1156"><a href="#KNN.function-1156"><span class="linenos">1156</span></a>
</span><span id="KNN.function-1157"><a href="#KNN.function-1157"><span class="linenos">1157</span></a>        <span class="c1"># If not on same chain add edge or</span>
</span><span id="KNN.function-1158"><a href="#KNN.function-1158"><span class="linenos">1158</span></a>        <span class="c1"># If on same chain and separation is sufficient add edge</span>
</span><span id="KNN.function-1159"><a href="#KNN.function-1159"><span class="linenos">1159</span></a>        <span class="k">if</span> <span class="n">condition_1</span> <span class="ow">or</span> <span class="n">condition_2</span><span class="p">:</span>
</span><span id="KNN.function-1160"><a href="#KNN.function-1160"><span class="linenos">1160</span></a>            <span class="n">add_edge</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">kind_name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds edges to nodes based on K nearest neighbours. Long interaction
threshold is used to specify minimum separation in sequence to add an edge
between networkx nodes within the distance threshold</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>G</strong>:  Protein Structure graph to add distance edges to</li>
<li><strong>long_interaction_threshold</strong>:  minimum distance in sequence for two
nodes to be connected</li>
<li><strong>k</strong>:  Number of neighbors for each sample.</li>
<li><strong>exclude_edges</strong>:  Types of edges to exclude. Supported values are
<code>inter</code> and <code>intra</code>.
<ul>
<li><code>inter</code> removes inter-connections between nodes of the same chain.</li>
<li><code>intra</code> removes intra-connections between nodes of different chains.</li>
</ul></li>
<li><strong>exclude_self_loops</strong>:  Whether or not to mark each sample as the first
nearest neighbor to itself.</li>
<li><strong>kind_name</strong>:  Name for kind of edges in networkx graph.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Graph with knn-based edges added</p>
</blockquote>
</div>


                            </div>
                            <div id="KNN.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;knn&#39;</span>

        
    </div>
    <a class="headerlink" href="#KNN.id"></a>
    
    

                            </div>
                            <div id="KNN.long_interaction_threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">long_interaction_threshold</span><span class="annotation">: int</span>        =
<span class="default_value">30</span>

        
    </div>
    <a class="headerlink" href="#KNN.long_interaction_threshold"></a>
    
    

                            </div>
                            <div id="KNN.k" class="classattr">
                                <div class="attr variable">
            <span class="name">k</span><span class="annotation">: int</span>        =
<span class="default_value">10</span>

        
    </div>
    <a class="headerlink" href="#KNN.k"></a>
    
    

                            </div>
                            <div id="KNN.exclude_edges" class="classattr">
                                <div class="attr variable">
            <span class="name">exclude_edges</span><span class="annotation">: Iterable[Literal[&#39;inter&#39;, &#39;intra&#39;]]</span>        =
<span class="default_value">()</span>

        
    </div>
    <a class="headerlink" href="#KNN.exclude_edges"></a>
    
    

                            </div>
                            <div id="KNN.exclude_self_loops" class="classattr">
                                <div class="attr variable">
            <span class="name">exclude_self_loops</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#KNN.exclude_self_loops"></a>
    
    

                            </div>
                            <div id="KNN.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{&#39;long_interaction_threshold&#39;: 30, &#39;k&#39;: 10, &#39;exclude_edges&#39;: (), &#39;exclude_self_loops&#39;: True}</span>

        
    </div>
    <a class="headerlink" href="#KNN.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="KNN.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="KNN.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="KNN.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="KNN.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PeptideBond">
                            <input id="PeptideBond-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PeptideBond</span><wbr>(<span class="base"><a href="../operator.html#EdgeConstructorFunctionOperator">bpp.data.graph.operator.EdgeConstructorFunctionOperator</a></span>):

                <label class="view-source-button" for="PeptideBond-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeptideBond"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeptideBond-69"><a href="#PeptideBond-69"><span class="linenos">69</span></a><span class="k">class</span> <span class="nc">PeptideBond</span><span class="p">(</span><span class="n">EdgeConstructorFunctionOperator</span><span class="p">):</span>
</span><span id="PeptideBond-70"><a href="#PeptideBond-70"><span class="linenos">70</span></a>
</span><span id="PeptideBond-71"><a href="#PeptideBond-71"><span class="linenos">71</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">GraphFunction</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">add_peptide_bonds</span>
</span><span id="PeptideBond-72"><a href="#PeptideBond-72"><span class="linenos">72</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;peptide_bond&quot;</span>
</span></pre></div>


    

                            <div id="PeptideBond.function" class="classattr">
                                        <input id="PeptideBond.function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">G</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span></span><span class="return-annotation">) -> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>:</span></span>

                <label class="view-source-button" for="PeptideBond.function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeptideBond.function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeptideBond.function-247"><a href="#PeptideBond.function-247"><span class="linenos">247</span></a><span class="k">def</span> <span class="nf">add_peptide_bonds</span><span class="p">(</span><span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
</span><span id="PeptideBond.function-248"><a href="#PeptideBond.function-248"><span class="linenos">248</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeptideBond.function-249"><a href="#PeptideBond.function-249"><span class="linenos">249</span></a><span class="sd">    Adds peptide backbone as edges to residues in each chain.</span>
</span><span id="PeptideBond.function-250"><a href="#PeptideBond.function-250"><span class="linenos">250</span></a>
</span><span id="PeptideBond.function-251"><a href="#PeptideBond.function-251"><span class="linenos">251</span></a><span class="sd">    :param G: Networkx protein graph.</span>
</span><span id="PeptideBond.function-252"><a href="#PeptideBond.function-252"><span class="linenos">252</span></a><span class="sd">    :type G: nx.Graph</span>
</span><span id="PeptideBond.function-253"><a href="#PeptideBond.function-253"><span class="linenos">253</span></a><span class="sd">    :return G: Networkx protein graph with added peptide bonds.</span>
</span><span id="PeptideBond.function-254"><a href="#PeptideBond.function-254"><span class="linenos">254</span></a><span class="sd">    :rtype: nx.Graph</span>
</span><span id="PeptideBond.function-255"><a href="#PeptideBond.function-255"><span class="linenos">255</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PeptideBond.function-256"><a href="#PeptideBond.function-256"><span class="linenos">256</span></a>    <span class="k">return</span> <span class="n">add_sequence_distance_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;peptide_bond&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds peptide backbone as edges to residues in each chain.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>G</strong>:  Networkx protein graph.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Networkx protein graph with added peptide bonds.</p>
</blockquote>
</div>


                            </div>
                            <div id="PeptideBond.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;peptide_bond&#39;</span>

        
    </div>
    <a class="headerlink" href="#PeptideBond.id"></a>
    
    

                            </div>
                            <div id="PeptideBond.default_args" class="classattr">
                                <div class="attr variable">
            <span class="name">default_args</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#PeptideBond.default_args"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../operator.html#FunctionOperator">bpp.data.graph.operator.FunctionOperator</a></dt>
                                <dd id="PeptideBond.__init__" class="function"><a href="../operator.html#FunctionOperator.__init__">FunctionOperator</a></dd>
                <dd id="PeptideBond.extra_args" class="variable"><a href="../operator.html#FunctionOperator.extra_args">extra_args</a></dd>

            </div>
            <div><dt><a href="../operator.html#Operator">bpp.data.graph.operator.Operator</a></dt>
                                <dd id="PeptideBond.kind" class="variable"><a href="../operator.html#Operator.kind">kind</a></dd>
                <dd id="PeptideBond.name" class="variable"><a href="../operator.html#Operator.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>